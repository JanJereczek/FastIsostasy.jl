<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>3D GIA benchmark · FastIsostasy.jl</title><meta name="title" content="3D GIA benchmark · FastIsostasy.jl"/><meta property="og:title" content="3D GIA benchmark · FastIsostasy.jl"/><meta property="twitter:title" content="3D GIA benchmark · FastIsostasy.jl"/><meta name="description" content="Documentation for FastIsostasy.jl."/><meta property="og:description" content="Documentation for FastIsostasy.jl."/><meta property="twitter:description" content="Documentation for FastIsostasy.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="FastIsostasy.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">FastIsostasy.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">FastIsostasy.jl</a></li><li><a class="tocitem" href="../../introGIA/">Quick intro to GIA</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../benchmark_analytic/">Analytical benchmark</a></li><li><a class="tocitem" href="../benchmark_1D/">1D GIA benchmark</a></li><li class="is-active"><a class="tocitem" href>3D GIA benchmark</a><ul class="internal"><li><a class="tocitem" href="#Case-1:-Reduction-of-lithospheric-thickness"><span>Case 1: Reduction of lithospheric thickness</span></a></li><li><a class="tocitem" href="#Case-2:-Increase-of-lithospheric-thickness"><span>Case 2: Increase of lithospheric thickness</span></a></li><li><a class="tocitem" href="#Case-3:-Reduction-of-mantle-viscosity"><span>Case 3: Reduction of mantle viscosity</span></a></li><li><a class="tocitem" href="#Case-4:-Increase-of-mantle-viscosity"><span>Case 4: Increase of mantle viscosity</span></a></li></ul></li><li><a class="tocitem" href="../alternative_models/">Alternative models</a></li><li><a class="tocitem" href="../glacialcycle/">Glacial cycle</a></li></ul></li><li><span class="tocitem">References</span><ul><li><a class="tocitem" href="../../APIref/">API reference</a></li><li><a class="tocitem" href="../../fortran/">Fortran version</a></li><li><a class="tocitem" href="../../references/">Bibliography</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>3D GIA benchmark</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>3D GIA benchmark</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JanJereczek/FastIsostasy.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JanJereczek/FastIsostasy.jl/blob/main/docs/src/examples/benchmark_3D.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="3D-GIA-benchmark"><a class="docs-heading-anchor" href="#3D-GIA-benchmark">3D GIA benchmark</a><a id="3D-GIA-benchmark-1"></a><a class="docs-heading-anchor-permalink" href="#3D-GIA-benchmark" title="Permalink"></a></h1><p>After comparing our results against analytical and 1D numerical solution, the obvious next step is to compare our results against 3D numerical solutions, where the lithospheric thickness and the mantle viscosity vary in x and y. We reproduce Test 3 from Swierczek-Jereczek et al. (2024), where a 1D Earth structure is perturbed by a Gaussian field in 4 different ways:</p><ol><li>A reduction of the lithospheric thickness from 150 km (at margin of the domain) to 50 km (at the center of the domain).</li><li>An increase of the lithospheric thickness from 150 km (at margin of the domain) to 250 km (at the center of the domain).</li><li>A reduction of the mantle viscosity from 10^21 Pa s (at margin of the domain) to 10^20 Pa s (at the center of the domain).</li><li>An increase of the mantle viscosity from 10^21 Pa s (at margin of the domain) to 10^22 Pa s (at the center of the domain).</li></ol><p>The ice load used as a forcing is the same as in the analytical example and the sea level computation is turned off to isolate the effect of a 3D Earth structure on the deformational response.</p><h2 id="Case-1:-Reduction-of-lithospheric-thickness"><a class="docs-heading-anchor" href="#Case-1:-Reduction-of-lithospheric-thickness">Case 1: Reduction of lithospheric thickness</a><a id="Case-1:-Reduction-of-lithospheric-thickness-1"></a><a class="docs-heading-anchor-permalink" href="#Case-1:-Reduction-of-lithospheric-thickness" title="Permalink"></a></h2><pre><code class="language-julia hljs">using FastIsostasy, CairoMakie, LinearAlgebra

W, n = 3f6, 7
domain = RegionalDomain(W, n)
H_ice_0 = zeros(domain)
H_ice_1 = 1f3 .* (domain.R .&lt; 1f6)
t_ice = [0, 1f-8, 50f3]
H_ice = [H_ice_0, H_ice_1, H_ice_1]
it = TimeInterpolatedIceThickness(t_ice, H_ice, domain)
bcs = BoundaryConditions(domain, ice_thickness = it)
sealevel = SeaLevel()

sigma = diagm([(W/4)^2, (W/4)^2])
thinning_lithosphere = generate_gaussian_field(domain, 150f3, [0f0, 0], -100f3, sigma)
solidearth = SolidEarth(
    domain,
    layer_boundaries = thinning_lithosphere,
    layer_viscosities = [1f21],
)
fig = plot_earth(domain, solidearth)</code></pre><img src="ba380da8.png" alt="Example block output"/><p>Now let&#39;s see what result we obtain:</p><pre><code class="language-julia hljs">nout = NativeOutput(vars = [:u, :ue], t = vcat(0, 1f3:1f3:4f3, 5f3, 10f3:10f3:50f3))
sim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)
run!(sim)
fig = plot_transect(sim, [:u, :ue])</code></pre><img src="2d344bf2.png" alt="Example block output"/><p>This is very similar to the result obtained by Seakon (3D GIA model) as presented in Swierczek-Jereczek et al. (2024, Fig. 8.a)! Let&#39;s dig into the other cases:</p><h2 id="Case-2:-Increase-of-lithospheric-thickness"><a class="docs-heading-anchor" href="#Case-2:-Increase-of-lithospheric-thickness">Case 2: Increase of lithospheric thickness</a><a id="Case-2:-Increase-of-lithospheric-thickness-1"></a><a class="docs-heading-anchor-permalink" href="#Case-2:-Increase-of-lithospheric-thickness" title="Permalink"></a></h2><pre><code class="language-julia hljs">thickenning_lithosphere = generate_gaussian_field(domain, 150f3, [0f0, 0], 100f3, sigma)

solidearth = SolidEarth(
    domain,
    layer_boundaries = thickenning_lithosphere,
    layer_viscosities = [1f21],
)
fig = plot_earth(domain, solidearth)</code></pre><img src="5188574b.png" alt="Example block output"/><p>Which is basically the opposite of Case 1!</p><p>Now let&#39;s see what result we obtain:</p><pre><code class="language-julia hljs">sim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)

run!(sim)
fig = plot_transect(sim, [:u, :ue])</code></pre><img src="9c5b6a26.png" alt="Example block output"/><p>It looks like a thicker lithosphere prevents flexure! This tends to &quot;spread&quot; the deformation by creating a higher lateral coupling between neighbouring cells. In comparison, a thin lithosphere makes the displacement more localized, as the flexural rigidity is lower and the cells are more decoupled from each other.</p><p>Comparing these results to those of Seakon gives a good match (Swierczek-Jereczek et al., 2024, Fig. 8.b). Now let&#39;s dive into cases of laterally-varying mantle viscosities.</p><h2 id="Case-3:-Reduction-of-mantle-viscosity"><a class="docs-heading-anchor" href="#Case-3:-Reduction-of-mantle-viscosity">Case 3: Reduction of mantle viscosity</a><a id="Case-3:-Reduction-of-mantle-viscosity-1"></a><a class="docs-heading-anchor-permalink" href="#Case-3:-Reduction-of-mantle-viscosity" title="Permalink"></a></h2><pre><code class="language-julia hljs">log10visc = generate_gaussian_field(domain, 21f0, [0f0, 0], -1f0, sigma)
solidearth = SolidEarth(
    domain,
    layer_boundaries = [150f3],
    layer_viscosities = reshape(10 .^ log10visc, domain.nx, domain.ny, 1),
    calibration = SeakonCalibration(),
)
fig = plot_earth(domain, solidearth)</code></pre><img src="196f5a24.png" alt="Example block output"/><p>Here we used <code>SeakonCalibration</code> as calibration passed to <code>SolidEarth</code>. As described in Appendix C of Swierczek-Jereczek et al. (2024), this allows to include the effect of a laterally varying shear modulus on the effective viscosity, which yields about 1f20.5 instead of the expected 1f20.</p><pre><code class="language-julia hljs">sim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)
run!(sim)
fig = plot_transect(sim, [:u, :ue])</code></pre><img src="a0cb2000.png" alt="Example block output"/><p>As expected, the displacement takes place much faster than in the previous cases. Comparing these results to those of Seakon gives a good match (Swierczek-Jereczek et al., 2024, Fig. 8.c).</p><h2 id="Case-4:-Increase-of-mantle-viscosity"><a class="docs-heading-anchor" href="#Case-4:-Increase-of-mantle-viscosity">Case 4: Increase of mantle viscosity</a><a id="Case-4:-Increase-of-mantle-viscosity-1"></a><a class="docs-heading-anchor-permalink" href="#Case-4:-Increase-of-mantle-viscosity" title="Permalink"></a></h2><p>We now perform the opposite viscosity perturbation to Case 3:</p><pre><code class="language-julia hljs">log10visc = generate_gaussian_field(domain, 21f0, [0f0, 0], 1f0, sigma)
solidearth = SolidEarth(
    domain,
    layer_boundaries = [150f3],
    layer_viscosities = reshape(10 .^ log10visc, domain.nx, domain.ny, 1),
    calibration = SeakonCalibration(),
)
fig = plot_earth(domain, solidearth)</code></pre><img src="fcde0372.png" alt="Example block output"/><p>Due to the applied calibration, the effective viscosity yields about 1f21.5 instead of the expected 1f22. This means that the calibration tends to reduce the difference between the viscosity and the reference one, set in <a href="../../APIref/#FastIsostasy.SeakonCalibration"><code>SeakonCalibration</code></a>.</p><pre><code class="language-julia hljs">sim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)
run!(sim)
fig = plot_transect(sim, [:u, :ue])</code></pre><img src="b0620387.png" alt="Example block output"/><p>As expected, the displacement takes place much slower than in the previous cases. Comparing these results to those of Seakon gives a good match (Swierczek-Jereczek et al., 2024, Fig. 8.d).</p><p>FastIsostasy performs these runs much faster than 3D GIA models (several orders of magnitude). For instance:</p><pre><code class="language-julia hljs">println(&quot;Computation time (s): $(sim.nout.computation_time)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Computation time (s): 2.021228</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../benchmark_1D/">« 1D GIA benchmark</a><a class="docs-footer-nextpage" href="../alternative_models/">Alternative models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 1 August 2025 15:27">Friday 1 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
