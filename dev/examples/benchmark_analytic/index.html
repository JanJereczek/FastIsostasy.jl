<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analytical benchmark · FastIsostasy.jl</title><meta name="title" content="Analytical benchmark · FastIsostasy.jl"/><meta property="og:title" content="Analytical benchmark · FastIsostasy.jl"/><meta property="twitter:title" content="Analytical benchmark · FastIsostasy.jl"/><meta name="description" content="Documentation for FastIsostasy.jl."/><meta property="og:description" content="Documentation for FastIsostasy.jl."/><meta property="twitter:description" content="Documentation for FastIsostasy.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="https://fonts.googleapis.com/css?family=Montserrat|Source+Code+Pro&amp;display=swap" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="FastIsostasy.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">FastIsostasy.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">FastIsostasy.jl</a></li><li><a class="tocitem" href="../../introGIA/">Quick intro to GIA</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Analytical benchmark</a><ul class="internal"><li><a class="tocitem" href="#Explicit-time-stepping-(recommended)"><span>Explicit time stepping (recommended)</span></a></li><li><a class="tocitem" href="#Implicit-time-stepping"><span>Implicit time stepping</span></a></li></ul></li><li><a class="tocitem" href="../benchmark_1D/">1D GIA benchmark</a></li><li><a class="tocitem" href="../benchmark_3D/">3D GIA benchmark</a></li><li><a class="tocitem" href="../alternative_models/">Alternative models</a></li><li><a class="tocitem" href="../glacialcycle/">Glacial cycle</a></li></ul></li><li><span class="tocitem">References</span><ul><li><a class="tocitem" href="../../API_public/">Public API</a></li><li><a class="tocitem" href="../../API_private/">Private API</a></li><li><a class="tocitem" href="../../fortran/">Fortran version</a></li><li><a class="tocitem" href="../../references/">Bibliography</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Analytical benchmark</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analytical benchmark</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JanJereczek/FastIsostasy.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JanJereczek/FastIsostasy.jl/blob/main/docs/src/examples/benchmark_analytic.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Analytical-benchmark"><a class="docs-heading-anchor" href="#Analytical-benchmark">Analytical benchmark</a><a id="Analytical-benchmark-1"></a><a class="docs-heading-anchor-permalink" href="#Analytical-benchmark" title="Permalink"></a></h1><h2 id="Explicit-time-stepping-(recommended)"><a class="docs-heading-anchor" href="#Explicit-time-stepping-(recommended)">Explicit time stepping (recommended)</a><a id="Explicit-time-stepping-(recommended)-1"></a><a class="docs-heading-anchor-permalink" href="#Explicit-time-stepping-(recommended)" title="Permalink"></a></h2><p>In this example, we want to compute the viscous displacement of the upper mantle resulting from a cylindrical ice load with a radius of 1000 km and a thickness of 1 km. To do so, we first generate the computation domain and the load:</p><pre><code class="language-julia hljs">using FastIsostasy, CairoMakie

W, n = 3f6, 7   # square domain with size 2*W and 2^n points in each dimension
domain = RegionalDomain(W, n)

H_ice_0 = zeros(domain)             # Load: 0 at the beginning...
H_ice_1 = 1f3 .* (domain.R .&lt; 1f6)  # cylinder afterwards
fig = plot_load(domain, H_ice_1)</code></pre><img src="38c7797e.png" alt="Example block output"/><p>This looks good! <code>plot_load</code> is a function of FastIsostasy that, similar to all functions <code>plot_*</code>, is only loaded if the user is <code>using Makie</code>. These functions are here to help the user visualize quickly the results that were obtained and are summarized in the <a href>API reference</a>.</p><p>First, we wrap the ice load as a time interpolator so that the boundary doncitions of FastIsostasy can be updated internally (if you want to update the ice thickness externally, have a look at <a href>this</a>). Then we define a solid earth structure, a sea-level model (that is inactive by default) and an output object. The simulation is subsequently executed with <code>run!()</code>. The Earth structure deserves particular attention, since it determines key properties of the problem. We here define a single layer boundary at 88 km depth. This means that the lithosphere is 88 km thick and the mantle below it is assumed to be a Maxwell body with a viscosity of 1f21 Pa s. The lithosphere density is set to 0, such that its displacement does not contribute to the pressure term of the isostatic adjustment (this is done to match Bueler et al., 2007).</p><pre><code class="language-julia hljs">t_ice = [0, 1, 50f3]
H_ice = [H_ice_0, H_ice_1, H_ice_1]
it = TimeInterpolatedIceThickness(t_ice, H_ice, domain)

bcs = BoundaryConditions(domain, ice_thickness = it)

solidearth = SolidEarth(    # Use the same geometry as in Bueler et al. (2007).
    domain,
    layer_boundaries = [88f3],
    layer_viscosities = [1f21],
    rho_litho = 0f0,
)

sealevel = RegionalSeaLevel()               # Will be inactive if not specified.

nout = NativeOutput(vars = [:u],    # only store viscous displacement.
    t = [100, 500, 1500, 5000, 10_000, 50_000f0])

sim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)
run!(sim)
fig = plot_transect(sim, [:u])</code></pre><img src="0b1e1d37.png" alt="Example block output"/><p>The viscous displacement field that we obtained is quite intuitive: its shape is largely determined by the forcing and its maximal amplitude is a fraction of the ice thickness is about \dfrac{ \rho<em>\mathrm{ice} }{ \rho</em>\mathrm{mantle} }. This simple example presents the advantage to have an analytical solution, which can be plotted along our solution:</p><pre><code class="language-julia hljs">fig = plot_transect(sim, [:u], analytic_cylinder_solution = true)</code></pre><img src="0278e7e8.png" alt="Example block output"/><p>Our numerical solution yields very small error!</p><p>FastIsostasy was designed to be computationally efficient. We are therefore particularly interested in the time needed for the computation, which is stored in the <code>nout</code> object of the simulation.</p><pre><code class="language-julia hljs">println(&quot;Computation time using explicit time stepping: $(sim.nout.computation_time)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Computation time using explicit time stepping: 0.960768</code></pre><p>This is the (compilation + computation) time that was required to compute 50 kyr of viscous displacement with a domain of 128x128 points!</p><h2 id="Implicit-time-stepping"><a class="docs-heading-anchor" href="#Implicit-time-stepping">Implicit time stepping</a><a id="Implicit-time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Implicit-time-stepping" title="Permalink"></a></h2><p>If the Earth structure is laterally constant (i.e. the lithospheric thickness and the mantle viscosity do not vary in x and y), the performance can be improved by using an implicit time stepping, as derived by Bueler et al. (2007). This can be achieved by specifying the lithosphere as <code>RigidLithosphere()</code> or as <code>LaterallyConstantLithosphere()</code> and requires to set a fixed time step via the <code>DiffEqOptions</code> in the <code>SolverOptions</code>:</p><pre><code class="language-julia hljs">solidearth = SolidEarth(
    domain,
    lithosphere = RigidLithosphere(),
    layer_boundaries = [88f3],
    layer_viscosities = [1f21],
)
opts = SolverOptions(diffeq = DiffEqOptions(alg = Euler(), dt_min = 100f0))
sim_implicit = Simulation(domain, bcs, sealevel, solidearth; nout = nout, opts = opts)
run!(sim_implicit)
fig = plot_transect(sim_implicit, [:u], analytic_cylinder_solution = true)</code></pre><img src="52790fd7.png" alt="Example block output"/><p>The results appear to be comparable with the previously obtained ones! However, the computation time is lower:</p><pre><code class="language-julia hljs">println(&quot;Computation time using implicit time stepping: $(sim_implicit.nout.computation_time)&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Computation time using implicit time stepping: 2.726849</code></pre><div class="admonition is-warning" id="Implicit-time-stepping-is-very-specific-b662fecc98ffc236"><header class="admonition-header">Implicit time stepping is very specific<a class="admonition-anchor" href="#Implicit-time-stepping-is-very-specific-b662fecc98ffc236" title="Permalink"></a></header><div class="admonition-body"><p>If you are not sure whether your Earth structure is laterally constant, you should not use the implicit time stepping. The results will be wrong if the lithosphere thickness or the mantle viscosity vary in x and y.</p></div></div><p>All of the computations shown above are performed with <code>Float32</code> as floating point precision. It is easy to switch to <code>Float64</code>, by passing arguments as such (e.g. <code>W = 3e6</code>). This will increase the accuracy of the results, but also the computation time. The default <code>Float32</code> is sufficient for most applications.</p><p>Of course, this example remains simple. If you want to learn how to increase the complexity of your simulations, go to the next examples!</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../introGIA/">« Quick intro to GIA</a><a class="docs-footer-nextpage" href="../benchmark_1D/">1D GIA benchmark »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 21 January 2026 03:43">Wednesday 21 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
