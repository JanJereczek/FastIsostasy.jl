var documenterSearchIndex = {"docs":
[{"location":"references/#Bibliography","page":"Bibliography","title":"Bibliography","text":"","category":"section"},{"location":"references/","page":"Bibliography","title":"Bibliography","text":"Bueler, E.; Lingle, C. S. and Brown, J. (2007). Fast computation of a viscoelastic deformable Earth model for ice-sheet simulations. Annals of Glaciology 46, 97–105. Accessed on Nov 15, 2022.\n\n\n\nCathles, L. M. (1975). Viscosity of the Earth's Mantle (Princeton University Press).\n\n\n\nIvins, E. R.; van der Wal, W.; Wiens, D. A.; Lloyd, A. J. and Caron, L. (2022). Antarctic upper mantle rheology. Geological Society, London, Memoirs 56, M56–2020–19. Accessed on Nov 29, 2022.\n\n\n\nLingle, C. S. and Clark, J. A. (1985). A numerical model of interactions between a marine ice sheet and the solid earth: Application to a West Antarctic ice stream. Journal of Geophysical Research 90, 1100. Accessed on Nov 23, 2022.\n\n\n\nPan, L.; Milne, G. A.; Latychev, K.; Goldberg, S. L.; Austermann, J.; Hoggard, M. J. and Mitrovica, J. X. (2022). The influence of lateral Earth structure on inferences of global ice volume during the Last Glacial Maximum. Quaternary Science Reviews 290, 107644. Accessed on Oct 4, 2023.\n\n\n\nPeltier, W. R.; Argus, D. F. and Drummond, R. (2018). Comment on “An Assessment of the ICE‐6G_C (VM5a) Glacial Isostatic Adjustment Model” by Purcell et al. Journal of Geophysical Research: Solid Earth 123, 2019–2028. Accessed on Sep 21, 2023.\n\n\n\nSwierczek-Jereczek, J.; Montoya, M.; Latychev, K.; Robinson, A.; Alvarez-Solas, J. and Mitrovica, J. (2024). FastIsostasy v1. 0–a regional, accelerated 2D glacial isostatic adjustment (GIA) model accounting for the lateral variability of the solid Earth. Geoscientific Model Development 17, 5263–5290.\n\n\n\nWhitehouse, P. L.; Gomez, N.; King, M. A. and Wiens, D. A. (2019). Solid Earth change and the evolution of the Antarctic Ice Sheet. Nature Communications 10, 503. Accessed on Nov 15, 2022.\n\n\n\nWiens, D. A.; Shen, W. and Lloyd, A. J. (2022). The seismic structure of the Antarctic upper mantle. Geological Society, London, Memoirs 56, M56–2020–18. Accessed on Dec 1, 2022.\n\n\n\n","category":"page"},{"location":"examples/benchmark_1D/#1D-GIA-benchmark","page":"1D GIA benchmark","title":"1D GIA benchmark","text":"","category":"section"},{"location":"examples/benchmark_1D/","page":"1D GIA benchmark","title":"1D GIA benchmark","text":"To make things a bit more interesting, we now propose to reproduce one of experiments proposed in a benchmark study of 1D GIA models (Spada et al. 2011). Test 1/2 (Fig. 9 and 10) consists of a 1D ice cap with a maximum thickness of 1500 m and a maximum latitude of 10° (i.e. the ice cap has a radius of about 1000 km wide). The lithosphere is assumed to be 100 km thick and the mantle is assumed to be layered, with a viscosity of 1e21 Pa s in the upper mantle and 2e21 Pa s in the lower mantle. The lithosphere is assumed to be elastic, with a Young's modulus of 70 GPa and a Poisson's ratio of 0.28. The ice load is applied at time t = 0 and kept constant until t = 100 kyr. The gravitational response and the resulting change in sea-surface elevation is computed, however without affecting the load that is applied to the solid Earth.","category":"page"},{"location":"examples/benchmark_1D/","page":"1D GIA benchmark","title":"1D GIA benchmark","text":"Note that Spada et al. (2011) use parameters that differ from FastIsostasy's default and that are passed to the simulation via PhysicalConstants and SolidEarth.","category":"page"},{"location":"examples/benchmark_1D/","page":"1D GIA benchmark","title":"1D GIA benchmark","text":"using FastIsostasy, CairoMakie\n\nW, n, T = 3f6, 7, Float32\ndomain = RegionalDomain(W, n)\nc = PhysicalConstants{T}(rho_ice = 0.931e3)\n\nH_ice_0 = zeros(domain)     # Load: 0 at the beginning\nalpha = T(10)               # Load: cap with max colatitude 10°...\nHmax = T(1500)              # ... and thickness 1500 m afterwards\nH_ice_1 = stereo_ice_cap(domain, alpha, Hmax)\nfig = plot_load(domain, H_ice_1)","category":"page"},{"location":"examples/benchmark_1D/","page":"1D GIA benchmark","title":"1D GIA benchmark","text":"This already looks a bit more like a real ice sheet! Again, let's wrap this into an interpolator passed to a BoundaryConditions instance. The current example is of interest because 1D GIA models include the elastic and the gravitational response to changes in the surface load. The former is included by default in SolidEarth (unless specified, as done in the previous example) and the latter can be specified in the SeaLevel instance:","category":"page"},{"location":"examples/benchmark_1D/","page":"1D GIA benchmark","title":"1D GIA benchmark","text":"t_ice = [-1f-3, 0, 100f3]\nH_ice = [H_ice_0, H_ice_1, H_ice_1]\nit = TimeInterpolatedIceThickness(t_ice, H_ice, domain)     # Wrap in time interpolator\nbcs = BoundaryConditions(domain, ice_thickness = it)        # Pass to boundary conditions\n\nsealevel = SeaLevel(surface = LaterallyVariableSeaSurface())    # gravitational response: on\n\nG = 0.50605f11              # Shear modulus (Pa)\nnu = 0.28f0                 # Poisson ratio\nE = G * 2 * (1 + nu)        # Young modulus\nlb = c.r_equator .- [6301f3, 5951f3, 5701f3]    # 3 layer boundaries\nsolidearth = SolidEarth(\n    domain,\n    layer_boundaries = T.(lb),\n    layer_viscosities = [1f21, 1f21, 2f21],\n    litho_youngmodulus = E,\n    litho_poissonratio = nu,\n    rho_litho = 3100f0,\n    rho_uppermantle = 3500f0,\n)\n\n\nnout = NativeOutput(vars = [:u, :ue, :dz_ss],               # Define the fields to be saved...\n    t = [0, 10, 1_000, 2_000, 5_000, 10_000, 100_000f0])    # And the time steps!\nsim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)\nrun!(sim)\nfig = plot_transect(sim, [:ue, :u, :dz_ss])","category":"page"},{"location":"examples/benchmark_1D/","page":"1D GIA benchmark","title":"1D GIA benchmark","text":"By comparing these results to Fig. 9 of Spada et al. (2011), we can see that the deformational and gravitational response obtained by FastIsostasy are very similar to that obtained by 1D GIA models. Let's see how much time was required for this:","category":"page"},{"location":"examples/benchmark_1D/","page":"1D GIA benchmark","title":"1D GIA benchmark","text":"println(\"Computation time (s): $(sim.nout.computation_time)\")","category":"page"},{"location":"examples/benchmark_1D/","page":"1D GIA benchmark","title":"1D GIA benchmark","text":"This is at least 2 orders of magnitude faster than typical 1D GIA models, without any major loss in accuracy!","category":"page"},{"location":"APIref/#API-reference","page":"API reference","title":"API reference","text":"","category":"section"},{"location":"APIref/#Simulation","page":"API reference","title":"Simulation","text":"","category":"section"},{"location":"APIref/#FastIsostasy.Simulation","page":"API reference","title":"FastIsostasy.Simulation","text":"Simulation(domain, c, solidearth, t_out)\nSimulation(domain, c, solidearth, t_out, Hice)\nSimulation(domain, c, solidearth, t_out, t_Hice, Hice)\n\nReturn a struct containing all the other structs needed for the forward integration of the model over domain::RegionalDomain with parameters c::PhysicalConstants and solidearth::SolidEarth. The outputs are stored at t_out::Vector{<:AbstractFloat}.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.SolverOptions","page":"API reference","title":"FastIsostasy.SolverOptions","text":"Return a struct containing the options relative to solving a Simulation.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.DiffEqOptions","page":"API reference","title":"FastIsostasy.DiffEqOptions","text":"Contains:\n\nalg::ODEsolvers: the algorithm to integrate the ODE forward in time.\nreltol: the relative error tolerance of the integrator.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.run!","page":"API reference","title":"FastIsostasy.run!","text":"run!(sim::Simulation)\n\n\nSolve the isostatic adjustment problem defined in sim::Simulation.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.init_integrator","page":"API reference","title":"FastIsostasy.init_integrator","text":"init_integrator(sim::Simulation) -> Any\n\n\nInitialise the integrator of sim::Simulation, which can be subsequently integrated forward in time by using step!.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Computation-domains","page":"API reference","title":"Computation domains","text":"","category":"section"},{"location":"APIref/#FastIsostasy.AbstractDomain","page":"API reference","title":"FastIsostasy.AbstractDomain","text":"Abstract type for domain representation in the model.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.RegionalDomain","page":"API reference","title":"FastIsostasy.RegionalDomain","text":"RegionalDomain\nRegionalDomain(W, n)\nRegionalDomain(Wx, Wy, nx, ny)\n\nReturn a struct containing all information related to geometry of the domain and potentially used parallelism. To initialize one with 2*W and 2^n grid cells:\n\ndomain = RegionalDomain(W, n)\n\nIf a rectangular domain is needed, run:\n\ndomain = RegionalDomain(Wx, Wy, nx, ny)\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.GlobalDomain","page":"API reference","title":"FastIsostasy.GlobalDomain","text":"Not implemented yet!\n\nVersion 3.0 will allow for global domains.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#Boundary-conditions","page":"API reference","title":"Boundary conditions","text":"","category":"section"},{"location":"APIref/#FastIsostasy.BoundaryConditions","page":"API reference","title":"FastIsostasy.BoundaryConditions","text":"A struct containing the boundary conditions of the problem:\n\nice_thickness: an instance of AbstractIceThickness that defines how the ice thickness is updated.\nviscous_displacement: a boundary condition for the viscous displacement, defined as an OffsetBC.\nelastic_displacement: a boundary condition for the elastic displacement, defined as an OffsetBC.\nsea_surface_perturbation: a boundary condition for the sea surface perturbation, defined as an OffsetBC.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.apply_bc!","page":"API reference","title":"FastIsostasy.apply_bc!","text":"apply_bc!(H, t, it::TimeInterpolatedIceThickness)\n\n\nUpdate the ice thickness H at time t using the method defined in it.\n\n\n\n\n\napply_bc!(X, bc::OffsetBC)\n\nApply the boundary condition bc to the matrix X in-place.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Ice-thickness","page":"API reference","title":"Ice thickness","text":"","category":"section"},{"location":"APIref/#FastIsostasy.AbstractIceThickness","page":"API reference","title":"FastIsostasy.AbstractIceThickness","text":"An abstract type that determines how the ice thickness is updated in the model. This is done by implementing the update_ice! function for different subtypes. Available subtypes are:\n\nTimeInterpolatedIceThickness\nExternallyUpdatedIceThickness\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.TimeInterpolatedIceThickness","page":"API reference","title":"FastIsostasy.TimeInterpolatedIceThickness","text":"A struct to update the ice thickness based on time interpolation. Contains:\n\nt_vec: a vector of time points at which the ice thickness is defined.\nH_vec: a vector of ice thickness values corresponding to t_vec.\nH_itp: a function that interpolates the ice thickness based on time.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.ExternallyUpdatedIceThickness","page":"API reference","title":"FastIsostasy.ExternallyUpdatedIceThickness","text":"ExternallyUpdatedIceThickness\n\nA struct to indicate that the ice thickness is updated externally, without any internal update.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#Boundary-condition-spaces","page":"API reference","title":"Boundary condition spaces","text":"","category":"section"},{"location":"APIref/#FastIsostasy.AbstractBCSpace","page":"API reference","title":"FastIsostasy.AbstractBCSpace","text":"An abstract type representing the space in which boundary conditions are defined. This typically needs to be defined when initializing an AbstractBCSpace. Available subtypes are:\n\nRegularBCSpace\nExtendedBCSpace\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.RegularBCSpace","page":"API reference","title":"FastIsostasy.RegularBCSpace","text":"Singleton struct to impose boundary conditions at the edges of the computation domain.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.ExtendedBCSpace","page":"API reference","title":"FastIsostasy.ExtendedBCSpace","text":"Singleton struct to impose boundary conditions at the edges of the extended computation domain, which naturally arises from convolutions.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#Boundary-condition-rules","page":"API reference","title":"Boundary condition rules","text":"","category":"section"},{"location":"APIref/#FastIsostasy.AbstractBC","page":"API reference","title":"FastIsostasy.AbstractBC","text":"An abstract type representing a boundary condition in the context of a computational domain. Available subtypes are:\n\nOffsetBC\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.OffsetBC","page":"API reference","title":"FastIsostasy.OffsetBC","text":"A boundary condition that applies an offset to the values at the boundaries of a computational domain. Contains:\n\nspace: the AbstractBCSpace in which the boundary condition is defined.\nx_border: the offset value to be applied at the boundaries.\nW: a weight matrix to apply the boundary condition according to some ÀbstractBCRule.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.NoBC","page":"API reference","title":"FastIsostasy.NoBC","text":"A singleton struct representing the absence of a boundary condition.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.CornerBC","page":"API reference","title":"FastIsostasy.CornerBC","text":"Impose a Dirichlet-like boundary condition at the corners of the computational domain.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.BorderBC","page":"API reference","title":"FastIsostasy.BorderBC","text":"Impose a Dirichlet-like boundary condition at the borders of the computational domain.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.DistanceWeightedBC","page":"API reference","title":"FastIsostasy.DistanceWeightedBC","text":"Impose a Dirichlet-like boundary condition at the borders of the computational domain, weighted by the distance from the center of the domain.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.MeanBC","page":"API reference","title":"FastIsostasy.MeanBC","text":"Impose a mean value for the field.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#Sea-level","page":"API reference","title":"Sea level","text":"","category":"section"},{"location":"APIref/#FastIsostasy.SeaLevel","page":"API reference","title":"FastIsostasy.SeaLevel","text":"A struct that gathers the modelling choices for the sea-level component of the simulation. It contains:\n\nsurface: an instance of AbstractSeaSurface to represent the sea surface.\nload: an instance of AbstractSealevelLoad to represent the sea-level load.\nbsl: an instance of AbstractBSL to represent the barystatic sea level.\nupdate_bsl: an instance of AbstractUpdateBSL to represent the update mechanism for the barystatic sea level.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#Barystatic-sea-level-(BSL)","page":"API reference","title":"Barystatic sea level (BSL)","text":"","category":"section"},{"location":"APIref/#FastIsostasy.AbstractBSL","page":"API reference","title":"FastIsostasy.AbstractBSL","text":"Abstract type to compute the evolution of the barystatic sea level. Available subtypes are:\n\nConstantBSL\nConstantOceanSurfaceBSL\nPiecewiseConstantBSL\nPiecewiseLinearBSL\nImposedBSL\nCombinedBSL\n\nAll subtypes implement the update_bsl! function:\n\nT, delta_V, t = Float64, 1.0e9, 0.0             # Example values\nbsl = PiecewiseConstantBSL()        # or any other subtype!\nupdate_bsl!(bsl, delta_V, t)\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.ConstantBSL","page":"API reference","title":"FastIsostasy.ConstantBSL","text":"A mutable struct containing:\n\nref: an instance of ReferenceBSL.\nz: the BSL, considered constant in time.\nA: the ocean surface area, considered constant in time.\n\nAssume that the BSL is constant in time.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.ConstantOceanSurfaceBSL","page":"API reference","title":"FastIsostasy.ConstantOceanSurfaceBSL","text":"A mutable struct containing:\n\nref: an instance of ReferenceBSL.\nz: the BSL at current time step.\nA: the ocean surface area, considered constant in time.\n\nAssume that the ocean surface is constant in time and that the BSL evolves only according to the changes in ice volume covered by the RegionalDomain.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.PiecewiseConstantBSL","page":"API reference","title":"FastIsostasy.PiecewiseConstantBSL","text":"A mutable struct containing:\n\nref: an instance of ReferenceBSL.\nz: the BSL at current time step.\nA: the ocean surface at current time step.\n\nAssume that the ocean surface evolves in time according to a piecewise constant function of the BSL, which evolves in time according to the changes in ice volume covered by the RegionalDomain.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.ImposedBSL","page":"API reference","title":"FastIsostasy.ImposedBSL","text":"A mutable struct containing:\n\nref: an instance of ReferenceBSL.\nz: the BSL at current time step.\nt_vec: the time vector.\nz_vec: the BSL values corresponding to the time vector.\nz_itp: an interpolation of z_vec over t_vec.\n\nImpose an externally computed BSL, which is internally computed via a time interpolation.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.CombinedBSL","page":"API reference","title":"FastIsostasy.CombinedBSL","text":"A mutable structcontaining:\n\nbsl1: an ImposedBSL.\nbsl2: an AbstractBSL.\n\nThis imposes a mixture of BSL. For instance, if you simulate Antarctica over the LGM, you can impose an offline BSL contribution from the other ice sheets via bsl1. The contribution of Antarctica will be intercatively added to this via bsl2.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.update_bsl!","page":"API reference","title":"FastIsostasy.update_bsl!","text":"update_bsl!(bsl::ConstantBSL, delta_V, t)\n\n\nUpdate the BSL and ocean surface based on the input delta_V (in m^3) and on a subtype of AbstractBSL.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Sea-surface-(gravitional-response)","page":"API reference","title":"Sea surface (gravitional response)","text":"","category":"section"},{"location":"APIref/#FastIsostasy.AbstractSeaSurface","page":"API reference","title":"FastIsostasy.AbstractSeaSurface","text":"Abstract type for sea surface representation. Available subtypes are:\n\nLaterallyConstantSeaSurface\nLaterallyVariableSeaSurface\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.LaterallyConstantSeaSurface","page":"API reference","title":"FastIsostasy.LaterallyConstantSeaSurface","text":"Assume a laterally constant sea surface across the domain. This means that the gravitatiional response is ignored.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.LaterallyVariableSeaSurface","page":"API reference","title":"FastIsostasy.LaterallyVariableSeaSurface","text":"Assume a laterally variable sea surface across the domain. This means that the gravitational response is included in the sea surface perturbation.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.update_dz_ss!","page":"API reference","title":"FastIsostasy.update_dz_ss!","text":"update_dz_ss!(\n    sim::Simulation,\n    sl::LaterallyVariableSeaSurface\n)\n\n\nUpdate the SSH perturbation dz_ss by convoluting the Green's function with the load anom.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Sea-level-load","page":"API reference","title":"Sea level load","text":"","category":"section"},{"location":"APIref/#FastIsostasy.AbstractSealevelLoad","page":"API reference","title":"FastIsostasy.AbstractSealevelLoad","text":"Abstract type for sea-level load representation. Available subtypes are:\n\nNoSealevelLoad\nInteractiveSealevelLoad\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.NoSealevelLoad","page":"API reference","title":"FastIsostasy.NoSealevelLoad","text":"Assume no sea-level load, i.e. the bedrock deformation is not influenced by the sea-level.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.InteractiveSealevelLoad","page":"API reference","title":"FastIsostasy.InteractiveSealevelLoad","text":"Assume an interactive sea-level load, i.e. the bedrock deformation is influenced by the sea-level.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.columnanom_water!","page":"API reference","title":"FastIsostasy.columnanom_water!","text":"columnanom_water!(\n    sim::Simulation,\n    ol::InteractiveSealevelLoad\n)\n\n\nUpdate the water column based on the instance of AbstractSealevelLoad.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Solid-Earth","page":"API reference","title":"Solid Earth","text":"","category":"section"},{"location":"APIref/#FastIsostasy.SolidEarth","page":"API reference","title":"FastIsostasy.SolidEarth","text":"Return a struct containing all information related to the lateral variability of solid-Earth parameters. To initialize with values other than default, run:\n\ndomain = RegionalDomain(3000e3, 7)\nlb = [100e3, 300e3]\nlv = [1e19, 1e21]\nsolidearth = SolidEarth(domain, layer_boundaries = lb, layer_viscosities = lv)\n\nwhich initializes a lithosphere of thickness T_1 = 100 mathrmkm, a viscous channel between T_1and T_2 = 300 mathrmkmand a viscous halfspace starting at T_2. This represents a homogenous case. For heterogeneous ones, simply make lb::Vector{Matrix}, lv::Vector{Matrix} such that the vector elements represent the lateral variability of each layer on the grid of domain::RegionalDomain.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#Lithosphere","page":"API reference","title":"Lithosphere","text":"","category":"section"},{"location":"APIref/#FastIsostasy.AbstractLithosphere","page":"API reference","title":"FastIsostasy.AbstractLithosphere","text":"Available subtypes are:\n\nRigidLithosphere\nLaterallyConstantLithosphere\nLaterallyVariableLithosphere\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.RigidLithosphere","page":"API reference","title":"FastIsostasy.RigidLithosphere","text":"Assume a rigid lithosphere, i.e. the elastic deformation is neglected.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.LaterallyConstantLithosphere","page":"API reference","title":"FastIsostasy.LaterallyConstantLithosphere","text":"Assume a laterally constant lithospheric thickness (and rigidity) across the domain. This generally improves the performance of the solver, but is less realistic.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.LaterallyVariableLithosphere","page":"API reference","title":"FastIsostasy.LaterallyVariableLithosphere","text":"Assume a laterally variable lithospheric thickness (and rigidity) across the domain. This generally improves the realism of the model, but is more computationally expensive.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.update_elasticresponse!","page":"API reference","title":"FastIsostasy.update_elasticresponse!","text":"update_elasticresponse!(\n    sim::Simulation,\n    lithosphere::AbstractLithosphere\n)\n\n\nUpdate the elastic response by convoluting the Green's function with the load anom. To use coefficients differing from [Farrell1972], see GIATools.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Mantle","page":"API reference","title":"Mantle","text":"","category":"section"},{"location":"APIref/#FastIsostasy.AbstractMantle","page":"API reference","title":"FastIsostasy.AbstractMantle","text":"Available subtypes are:\n\nRigidMantle\nRelaxedMantle\nMaxwellMantle\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.RigidMantle","page":"API reference","title":"FastIsostasy.RigidMantle","text":"Assume a rigid mantle that does not deform.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.RelaxedMantle","page":"API reference","title":"FastIsostasy.RelaxedMantle","text":"Assume a relaxed mantle that deforms according to a relaxation time. This is generally less realistic and offers worse performance than a viscous mantle. It is only included for legacy purpose (e.g. comparison among solvers).\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.MaxwellMantle","page":"API reference","title":"FastIsostasy.MaxwellMantle","text":"Assume a viscous mantle that deforms according to a viscosity. This is the most realistic mantle model and generally offers the best performance. It is the default mantle model used in the solver.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.update_dudt!","page":"API reference","title":"FastIsostasy.update_dudt!","text":"update_dudt!(dudt, u, sim, t, earth::SolidEarth) -> Any\n\n\nUpdate the time derivative of the viscous displacement dudt based on an Model:\n\nRigidMantle: no deformation, dudt is zero.\nRelaxedMantle with LaterallyConstantLithosphere: uses ELRA (LeMeur & Huybrechts 1996) to compute the viscous response. This also works with laterally-variable relaxation time, as proposed in Van Calcar et al., in rev.\nRelaxedMantle with LaterallyVariableLithosphere: not implemented. This corresponds to what is described in Coulon et al. (2021) but is not yet implemented.\nMaxwellMantle with LaterallyConstantLithosphere or RigidLithosphere: not implemented. This corresponds to what is described in Bueler et al. (2007) but is not yet implemented.\nMaxwellMantle with LaterallyVariableLithosphere: This corresponds to the approach of Swierczek-Jereczek et al. (2024).\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Layering","page":"API reference","title":"Layering","text":"","category":"section"},{"location":"APIref/#FastIsostasy.AbstractLayering","page":"API reference","title":"FastIsostasy.AbstractLayering","text":"Abstract type for layering models. Subtypes should implement the layer_boundaries function. Available subtypes are:\n\nUniformLayering\nParallelLayering\nEqualizedLayering\nFoldedLayering\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.UniformLayering","page":"API reference","title":"FastIsostasy.UniformLayering","text":"Struct to enforce uniform layering when passed to get_layer_boundaries. Contains:\n\nn_layers: the number of layers in the model.\nboundaries: the layer boundaries, which are constant across the domain.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.ParallelLayering","page":"API reference","title":"FastIsostasy.ParallelLayering","text":"Struct to enforce parallel layering when passed to get_layer_boundaries. Contains:\n\nn_layers: the number of layers in the model.\nthickness: the thickness of each layer.\ntol: a tolerance value to add to the layer boundaries.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.EqualizedLayering","page":"API reference","title":"FastIsostasy.EqualizedLayering","text":"Struct to enforce equalized layering when passed to get_layer_boundaries. Contains:\n\nn_layers: the number of layers in the model.\nboundaries: the layer boundaries.\ntol: a tolerance value to add to the layer boundaries.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.FoldedLayering","page":"API reference","title":"FastIsostasy.FoldedLayering","text":"Struct to enforce folded layering when passed to get_layer_boundaries. Contains:\n\nn_layers: the number of layers in the model.\nmax_depth: the maximum depth of the layers.\ntol: a tolerance value to add to the layer boundaries.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.get_layer_boundaries","page":"API reference","title":"FastIsostasy.get_layer_boundaries","text":"get_layer_boundaries(\n    domain::RegionalDomain,\n    litho_thickness,\n    layering\n) -> Any\n\n\nCompute the layer boundaries for a given AbstractLayering. Output is typically passed to SolidEarth to create a layered Earth model.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Calibration","page":"API reference","title":"Calibration","text":"","category":"section"},{"location":"APIref/#FastIsostasy.AbstractCalibration","page":"API reference","title":"FastIsostasy.AbstractCalibration","text":"\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.NoCalibration","page":"API reference","title":"FastIsostasy.NoCalibration","text":"\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.SeakonCalibration","page":"API reference","title":"FastIsostasy.SeakonCalibration","text":"\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.apply_calibration!","page":"API reference","title":"FastIsostasy.apply_calibration!","text":"apply_calibration!(eta, calibraton::NoCalibration) -> Any\n\n\nApply the calibration to the viscosity eta.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Viscosity-lumping","page":"API reference","title":"Viscosity lumping","text":"","category":"section"},{"location":"APIref/#FastIsostasy.AbstractViscosityLumping","page":"API reference","title":"FastIsostasy.AbstractViscosityLumping","text":"\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.TimeDomainViscosityLumping","page":"API reference","title":"FastIsostasy.TimeDomainViscosityLumping","text":"\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.FreqDomainViscosityLumping","page":"API reference","title":"FastIsostasy.FreqDomainViscosityLumping","text":"\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.MeanViscosityLumping","page":"API reference","title":"FastIsostasy.MeanViscosityLumping","text":"\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.MeanLogViscosityLumping","page":"API reference","title":"FastIsostasy.MeanLogViscosityLumping","text":"\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.get_effective_viscosity_and_scaling","page":"API reference","title":"FastIsostasy.get_effective_viscosity_and_scaling","text":"get_effective_viscosity_and_scaling(\n    domain,\n    layer_viscosities,\n    layer_boundaries,\n    maskactive,\n    lumping::TimeDomainViscosityLumping\n) -> Tuple{Any, Any}\n\n\nCompute equivalent viscosity for multilayer model by recursively applying the formula for a halfspace and a channel from Lingle and Clark (1975).\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Material-utilities","page":"API reference","title":"Material utilities","text":"","category":"section"},{"location":"APIref/#FastIsostasy.get_rigidity","page":"API reference","title":"FastIsostasy.get_rigidity","text":"get_rigidity(t, E, nu) -> Any\n\n\nCompute rigidity D based on thickness t, Young modulus E and Poisson ration nu.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.get_shearmodulus","page":"API reference","title":"FastIsostasy.get_shearmodulus","text":"get_shearmodulus(youngmodulus, poissonratio) -> Any\n\n\nCompute shear modulus G based on Young modulus E and Poisson ratio nu, or based on seismic velocities.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.get_elastic_green","page":"API reference","title":"FastIsostasy.get_elastic_green","text":"get_elastic_green(\n    domain::RegionalDomain,\n    greenintegrand_function,\n    quad_support,\n    quad_coeffs\n) -> Matrix{T} where T<:AbstractFloat\n\n\nIntegrate load response over field by using 2D quadrature with specified support points and associated coefficients.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.get_flexural_lengthscale","page":"API reference","title":"FastIsostasy.get_flexural_lengthscale","text":"get_flexural_lengthscale(\n    litho_rigidity,\n    rho_uppermantle,\n    g\n) -> Any\n\n\nCompute the flexural length scale, based on Coulon et al. (2021), Eq. in text after Eq. 3. The flexural length scale will be on the order of 100km.\n\nArguments\n\nlitho_rigidity: Lithospheric rigidity\nrho_uppermantle: Density of the upper mantle\ng: Gravitational acceleration\n\nReturns\n\nL_w: The calculated flexural length scale\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.get_relaxation_time","page":"API reference","title":"FastIsostasy.get_relaxation_time","text":"get_relaxation_time(eta, m, p) -> Any\n\n\nConvert the viscosity to relaxation times following Van Calcar et al. (in rev.).\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.get_relaxation_time_weaker","page":"API reference","title":"FastIsostasy.get_relaxation_time_weaker","text":"get_relaxation_time_weaker(eta) -> Any\n\n\nCompute the relaxation time for a weaker mantle, following Van Calcar et al. (in rev.).\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.get_relaxation_time_stronger","page":"API reference","title":"FastIsostasy.get_relaxation_time_stronger","text":"get_relaxation_time_stronger(eta) -> Any\n\n\nCompute the relaxation time for a stronger mantle, following Van Calcar et al. (in rev.).\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Input/Output-(I/O)","page":"API reference","title":"Input/Output (I/O)","text":"","category":"section"},{"location":"APIref/#FastIsostasy.load_dataset","page":"API reference","title":"FastIsostasy.load_dataset","text":"load_dataset(\n    name::String;\n    kwargs...\n) -> Union{Nothing, Tuple{Any, Any, Any}}\n\n\nReturn the dims::Tuple{Vararg{Vector}}, the field<:Array and the interpolator corresponding to a data set defined by a unique name::String. For instance:\n\n(lon180, lat, t), Hice, Hice_itp = load_dataset(\"ICE6G_D\")\n\nFollowing options are available for parameter fields:\n\n\"ICE6GD\": ice loading history from ICE6GD.\n\"Wiens2022\": viscosity field from (Wiens et al. 2022)\n\"Lithothickness_Pan2022\": lithospheric thickness field from (Pan et al. 2022)\n\"Viscosity_Pan2022\": viscosity field from (Pan et al. 2022)\n\nFollowing options are available for model results:\n\n\"Spada2011\"\n\"LatychevGaussian\"\n\"LatychevICE6G\"\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.NetcdfOutput","page":"API reference","title":"FastIsostasy.NetcdfOutput","text":"A struct that contains all the necessary information to store the output in a NetCDF file.\n\nCan be initilized as:\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.NativeOutput","page":"API reference","title":"FastIsostasy.NativeOutput","text":"Return a mutable struct containing the native output which will be updated over the simulation.\n\nInitialization example:\n\nnout = NativeOutput(vars = [:u, :ue, :b, :dz_ss, :H_ice, :H_water, :u_x, :u_y],\n    t = collect(0:1f3:10f3))\n\n\n\n\n\n","category":"type"},{"location":"APIref/#Makie-utilities","page":"API reference","title":"Makie utilities","text":"","category":"section"},{"location":"APIref/#FastIsostasy.plot_transect","page":"API reference","title":"FastIsostasy.plot_transect","text":"\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.plot_load","page":"API reference","title":"FastIsostasy.plot_load","text":"\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.plot_earth","page":"API reference","title":"FastIsostasy.plot_earth","text":"\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.plot_out_at_time","page":"API reference","title":"FastIsostasy.plot_out_at_time","text":"\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.plot_out_over_time","page":"API reference","title":"FastIsostasy.plot_out_over_time","text":"\n\n\n\n","category":"function"},{"location":"models/","page":"-","title":"-","text":"GIA typically consist of a gravitational, a rotational and a deformational response, which motivates the use of GRD as a commonly used alternative accronym. FastIsostasy ignores the rotational response but approximates the gravitational one. The deformational response can be represented by a wide variety of models. The most sophisticated one is able to represent the laterally-variable mantle viscosity and lithospheric thickness. It is described in Swierczek-Jereczek et al. (2024) and is mainly adressed to ice-sheet modellers who seek for a good representation of solid-Earth mechanics at virtually zero computational cost. The simple interface of FastIsostasy allows to flexibly solve GIA problems within a few lines of code. The code is distributed under GNU general public license v3 and was succesfully benchmarked against analytical, 1D GIA and 3D GIA model solutions.","category":"page"},{"location":"models/","page":"-","title":"-","text":"Based on the work of Cathles (1975) and Lingle and Clark (1985), an efficient way of solving for the vertical displacement was proposed by Bueler et al. (2007). FastIsostasy generalises this approach by relying on a hybrid Fourier/finite-difference collocation. Thanks to a simplification of the full problem from 3D to 2D space and the use of optimized software packages, running kiloyears of regional GIA with Delta x = Delta y = 45  mathrmkm is a matter of seconds on a single CPU. For high resolution runs, the user can switch to GPU usage with minimal syntax change and enjoy the advantage of parallelization without requiring an HPC cluster. For GIA \"purists\", this package is likely to miss interesting processes but we belive that its ridiculous run-time can help to fast-prototype a problem before transfering it to a more comprehensive model.","category":"page"},{"location":"examples/benchmark_3D/#3D-GIA-benchmark","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"","category":"section"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"After comparing our results against analytical and 1D numerical solution, the obvious next step is to compare our results against 3D numerical solutions, where the lithospheric thickness and the mantle viscosity vary in x and y. We reproduce Test 3 from Swierczek-Jereczek et al. (2024), where a 1D Earth structure is perturbed by a Gaussian field in 4 different ways:","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"A reduction of the lithospheric thickness from 150 km (at margin of the domain) to 50 km (at the center of the domain).\nAn increase of the lithospheric thickness from 150 km (at margin of the domain) to 250 km (at the center of the domain).\nA reduction of the mantle viscosity from 10^21 Pa s (at margin of the domain) to 10^20 Pa s (at the center of the domain).\nAn increase of the mantle viscosity from 10^21 Pa s (at margin of the domain) to 10^22 Pa s (at the center of the domain).","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"The ice load used as a forcing is the same as in the analytical example and the sea level computation is turned off to isolate the effect of a 3D Earth structure on the deformational response.","category":"page"},{"location":"examples/benchmark_3D/#Case-1:-Reduction-of-lithospheric-thickness","page":"3D GIA benchmark","title":"Case 1: Reduction of lithospheric thickness","text":"","category":"section"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"using FastIsostasy, CairoMakie, LinearAlgebra\n\nW, n = 3f6, 7\ndomain = RegionalDomain(W, n)\nH_ice_0 = zeros(domain)\nH_ice_1 = 1f3 .* (domain.R .< 1f6)\nt_ice = [0, 1f-8, 50f3]\nH_ice = [H_ice_0, H_ice_1, H_ice_1]\nit = TimeInterpolatedIceThickness(t_ice, H_ice, domain)\nbcs = BoundaryConditions(domain, ice_thickness = it)\nsealevel = SeaLevel()\n\nsigma = diagm([(W/4)^2, (W/4)^2])\nthinning_lithosphere = generate_gaussian_field(domain, 150f3, [0f0, 0], -100f3, sigma)\nsolidearth = SolidEarth(\n    domain,\n    layer_boundaries = thinning_lithosphere,\n    layer_viscosities = [1f21],\n)\nfig = plot_earth(domain, solidearth)","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"Now let's see what result we obtain:","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"nout = NativeOutput(vars = [:u, :ue], t = vcat(0, 1f3:1f3:4f3, 5f3, 10f3:10f3:50f3))\nsim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)\nrun!(sim)\nfig = plot_transect(sim, [:u, :ue])","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"This is very similar to the result obtained by Seakon (3D GIA model) as presented in Swierczek-Jereczek et al. (2024, Fig. 8.a)! Let's dig into the other cases:","category":"page"},{"location":"examples/benchmark_3D/#Case-2:-Increase-of-lithospheric-thickness","page":"3D GIA benchmark","title":"Case 2: Increase of lithospheric thickness","text":"","category":"section"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"thickenning_lithosphere = generate_gaussian_field(domain, 150f3, [0f0, 0], 100f3, sigma)\n\nsolidearth = SolidEarth(\n    domain,\n    layer_boundaries = thickenning_lithosphere,\n    layer_viscosities = [1f21],\n)\nfig = plot_earth(domain, solidearth)","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"Which is basically the opposite of Case 1!","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"Now let's see what result we obtain:","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"sim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)\n\nrun!(sim)\nfig = plot_transect(sim, [:u, :ue])","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"It looks like a thicker lithosphere prevents flexure! This tends to \"spread\" the deformation by creating a higher lateral coupling between neighbouring cells. In comparison, a thin lithosphere makes the displacement more localized, as the flexural rigidity is lower and the cells are more decoupled from each other.","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"Comparing these results to those of Seakon gives a good match (Swierczek-Jereczek et al., 2024, Fig. 8.b). Now let's dive into cases of laterally-varying mantle viscosities.","category":"page"},{"location":"examples/benchmark_3D/#Case-3:-Reduction-of-mantle-viscosity","page":"3D GIA benchmark","title":"Case 3: Reduction of mantle viscosity","text":"","category":"section"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"log10visc = generate_gaussian_field(domain, 21f0, [0f0, 0], -1f0, sigma)\nsolidearth = SolidEarth(\n    domain,\n    layer_boundaries = [150f3],\n    layer_viscosities = reshape(10 .^ log10visc, domain.nx, domain.ny, 1),\n    calibration = SeakonCalibration(),\n)\nfig = plot_earth(domain, solidearth)","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"Here we used SeakonCalibration as calibration passed to SolidEarth. As described in Appendix C of Swierczek-Jereczek et al. (2024), this allows to include the effect of a laterally varying shear modulus on the effective viscosity, which yields about 1f20.5 instead of the expected 1f20.","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"sim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)\nrun!(sim)\nfig = plot_transect(sim, [:u, :ue])","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"As expected, the displacement takes place much faster than in the previous cases. Comparing these results to those of Seakon gives a good match (Swierczek-Jereczek et al., 2024, Fig. 8.c).","category":"page"},{"location":"examples/benchmark_3D/#Case-4:-Increase-of-mantle-viscosity","page":"3D GIA benchmark","title":"Case 4: Increase of mantle viscosity","text":"","category":"section"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"We now perform the opposite viscosity perturbation to Case 3:","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"log10visc = generate_gaussian_field(domain, 21f0, [0f0, 0], 1f0, sigma)\nsolidearth = SolidEarth(\n    domain,\n    layer_boundaries = [150f3],\n    layer_viscosities = reshape(10 .^ log10visc, domain.nx, domain.ny, 1),\n    calibration = SeakonCalibration(),\n)\nfig = plot_earth(domain, solidearth)","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"Due to the applied calibration, the effective viscosity yields about 1f21.5 instead of the expected 1f22. This means that the calibration tends to reduce the difference between the viscosity and the reference one, set in SeakonCalibration.","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"sim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)\nrun!(sim)\nfig = plot_transect(sim, [:u, :ue])","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"As expected, the displacement takes place much slower than in the previous cases. Comparing these results to those of Seakon gives a good match (Swierczek-Jereczek et al., 2024, Fig. 8.d).","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"FastIsostasy performs these runs much faster than 3D GIA models (several orders of magnitude). For instance:","category":"page"},{"location":"examples/benchmark_3D/","page":"3D GIA benchmark","title":"3D GIA benchmark","text":"println(\"Computation time (s): $(sim.nout.computation_time)\")","category":"page"},{"location":"examples/benchmark_analytic/#Analytical-benchmark","page":"Analytical benchmark","title":"Analytical benchmark","text":"","category":"section"},{"location":"examples/benchmark_analytic/#Explicit-time-stepping-(recommended)","page":"Analytical benchmark","title":"Explicit time stepping (recommended)","text":"","category":"section"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"In this example, we want to compute the viscous displacement of the upper mantle resulting from a cylindrical ice load with a radius of 1000 km and a thickness of 1 km. To do so, we first generate the computation domain and the load:","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"using FastIsostasy, CairoMakie\n\nW, n = 3f6, 7   # square domain with size 2*W and 2^n points in each dimension\ndomain = RegionalDomain(W, n)\n\nH_ice_0 = zeros(domain)             # Load: 0 at the beginning...\nH_ice_1 = 1f3 .* (domain.R .< 1f6)  # cylinder afterwards\nfig = plot_load(domain, H_ice_1)","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"This looks good! plot_load is a function of FastIsostasy that, similar to all functions plot_*, is only loaded if the user is using Makie. These functions are here to help the user visualize quickly the results that were obtained and are summarized in the API reference.","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"First, we wrap the ice load as a time interpolator so that the boundary doncitions of FastIsostasy can be updated internally (if you want to update the ice thickness externally, have a look at this). Then we define a solid earth structure, a sea-level model (that is inactive by default) and an output object. The simulation is subsequently executed with run!(). The Earth structure deserves particular attention, since it determines key properties of the problem. We here define a single layer boundary at 88 km depth. This means that the lithosphere is 88 km thick and the mantle below it is assumed to be a Maxwell body with a viscosity of 1f21 Pa s. The lithosphere density is set to 0, such that its displacement does not contribute to the pressure term of the isostatic adjustment (this is done to match Bueler et al., 2007).","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"t_ice = [0, 1, 50f3]\nH_ice = [H_ice_0, H_ice_1, H_ice_1]\nit = TimeInterpolatedIceThickness(t_ice, H_ice, domain)\n\nbcs = BoundaryConditions(domain, ice_thickness = it)\n\nsolidearth = SolidEarth(    # Use the same geometry as in Bueler et al. (2007).\n    domain,\n    layer_boundaries = [88f3],\n    layer_viscosities = [1f21],\n    rho_litho = 0f0,\n)\n\nsealevel = SeaLevel()               # Will be inactive if not specified.\n\nnout = NativeOutput(vars = [:u],    # only store viscous displacement.\n    t = [100, 500, 1500, 5000, 10_000, 50_000f0])\n\nsim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)\nrun!(sim)\nfig = plot_()","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"The viscous displacement field that we obtained is quite intuitive: its shape is largely determined by the forcing and its maximal amplitude is a fraction of the ice thickness is about \\dfrac{ \\rho\\mathrm{ice} }{ \\rho\\mathrm{mantle} }. This simple example presents the advantage to have an analytical solution, which can be plotted along our solution:","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"fig = plot_transect(sim, [:u], analytic_cylinder_solution = true)","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"Our numerical solution yields very small error!","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"FastIsostasy was designed to be computationally efficient. We are therefore particularly interested in the time needed for the computation, which is stored in the nout object of the simulation.","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"println(\"Computation time using explicit time stepping: $(sim.nout.computation_time)\")","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"This is the (compilation + computation) time that was required to compute 50 kyr of viscous displacement with a domain of 128x128 points!","category":"page"},{"location":"examples/benchmark_analytic/#Implicit-time-stepping","page":"Analytical benchmark","title":"Implicit time stepping","text":"","category":"section"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"If the Earth structure is laterally constant (i.e. the lithospheric thickness and the mantle viscosity do not vary in x and y), the performance can be improved by using an implicit time stepping, as derived by Bueler et al. (2007). This can be achieved by specifying the lithosphere as RigidLithosphere() or as LaterallyConstantLithosphere() and requires to set a fixed time step via the DiffEqOptions in the SolverOptions:","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"solidearth = SolidEarth(\n    domain,\n    lithosphere = RigidLithosphere(),\n    layer_boundaries = [88f3],\n    layer_viscosities = [1f21],\n)\nopts = SolverOptions(diffeq = DiffEqOptions(alg = Euler(), dt_min = 100f0))\nsim_implicit = Simulation(domain, bcs, sealevel, solidearth; nout = nout, opts = opts)\nrun!(sim_implicit)\nfig = plot_transect(sim_implicit, [:u], analytic_cylinder_solution = true)","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"The results appear to be comparable with the previously obtained ones! However, the computation time is lower:","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"println(\"Computation time using implicit time stepping: $(sim_implicit.nout.computation_time)\")","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"warning: Implicit time stepping is very specific\nIf you are not sure whether your Earth structure is laterally constant, you should not use the implicit time stepping. The results will be wrong if the lithosphere thickness or the mantle viscosity vary in x and y.","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"All of the computations shown above are performed with Float32 as floating point precision. It is easy to switch to Float64, by passing arguments as such (e.g. W = 3e6). This will increase the accuracy of the results, but also the computation time. The default Float32 is sufficient for most applications.","category":"page"},{"location":"examples/benchmark_analytic/","page":"Analytical benchmark","title":"Analytical benchmark","text":"Of course, this example remains simple. If you want to learn how to increase the complexity of your simulations, go to the next examples!","category":"page"},{"location":"introGIA/#Quick-intro-to-GIA","page":"Quick intro to GIA","title":"Quick intro to GIA","text":"","category":"section"},{"location":"introGIA/","page":"Quick intro to GIA","title":"Quick intro to GIA","text":"Glacial isostatic adjustment (GIA) denotes the crustal deformation that results from changes in the ice, liquid water and sediment columns, as well as associated changes in Earth's gravity and rotation axis, ultimately impacting the sea level. The magnitude and time scale of the deformational response depends on the applied load and on solid-Earth parameters, i.e. the mantle viscosity, the lithosphere thickness and their respective density. These parameters display a radial and sometimes also a lateral variability. For further details, please refer to Wiens et al. (2022) and Ivins et al. (2022).","category":"page"},{"location":"introGIA/#Why-do-we-care?","page":"Quick intro to GIA","title":"Why do we care?","text":"","category":"section"},{"location":"introGIA/","page":"Quick intro to GIA","title":"Quick intro to GIA","text":"GIA is known to present many feedbacks on ice-sheet evolution (Whitehouse et al., 2019). Their net effect is negative, meaning that GIA inhibits ice-sheet growth and retreat. A good representation of GIA is therefore needed to obtain realistic paleoclimatic reconstructions of ice sheets, as well as reliable projections of future sea level rise due to anthropogenic warming. The effect of GIA in this context appears to be particularly relevant as a large portion of human societies are concentrated along coasts.","category":"page"},{"location":"fortran/#Fortran-version","page":"Fortran version","title":"Fortran version","text":"","category":"section"},{"location":"fortran/","page":"Fortran version","title":"Fortran version","text":"Since Julia does not allow compilation to binaries yet, some researchers might find it hard to couple FastIsostasy.jl to their favourite ice-sheet model. To tackle this, a Fortran version has been developed. It however lacks some features, which are summarised below:","category":"page"},{"location":"fortran/","page":"Fortran version","title":"Fortran version","text":"Library of time-integration methods reduced to explicit Euler,\nOnly fixed time stepping allowed,\nComputation on GPU not supported.","category":"page"},{"location":"fortran/","page":"Fortran version","title":"Fortran version","text":"These discrepancies are unlikely to be gapped in the future, mostly because the Fortran ecosystem is less extensive than the Julia one.","category":"page"},{"location":"examples/glacialcycle/#Glacial-cycle","page":"Glacial cycle","title":"Glacial cycle","text":"","category":"section"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"The previous examples focused on benchmarking FastIsostasy against analytical, numerical 1D and numerical 3D solutions. However, these cases were largely idealised. To test the model on more realistic simulations, we now provide compute the GIA response in Antarctica over the last glacial cycle. This includes the use of:","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"a heterogeneous lithosphere thickness (Pan et al., 2022),\na heterogeneous upper-mantle viscosity (Pan et al., 2022),\na stack of few viscous channels,\na more elaborate load that evolves over time (Peltier et al., 2018),\ntransient changes of the relative sea-level.","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"We start by generating a RegionalDomain with intermediate resolution for the sake of the example and load the ice history thanks to the convenience of load_dataset. To get an idea of the ICE6G forcing, the ice thickness is visualised at the last glacial maximum (LGM):","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"using CairoMakie, FastIsostasy\n\nN = 140\ndomain = RegionalDomain(3500e3, 3500e3, N, N)   # resolution = 50 km\nLon, Lat = domain.Lon, domain.Lat\n(_, _, t), Hice, Hitp = load_dataset(\"ICE6G_D\")\nHice_vec = [Hitp.(Lon, Lat, tk) for tk in t]\nk_lgm = argmax([mean(Hice_vec[k]) for k in eachindex(Hice_vec)])\nplot_load(domain, Hice_vec[k_lgm])","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"This already looks like a much more exciting ice thickness field! Here again, the ice history is wrapped into an interpolator, which is passed to an instance of BoundaryConditions. We define the SeaLevel to include the gravitational response by making the surface a LaterallyVariableSeaSurface. Furthermore, we allow the changes in sea level to affect the deformational response of the solid Earth by setting InteractiveSealevelLoad. Finally, we compute the evolution of the barystatic sea level (BSL) according to a piece-wise constant approximation of the ocean surface as a function of the BSL:","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"it = TimeInterpolatedIceThickness(t .* 1e3, Hice_vec, domain)\nbcs = BoundaryConditions(domain, ice_thickness = it)\nsealevel = SeaLevel(\n    surface = LaterallyVariableSeaSurface(),\n    load = InteractiveSealevelLoad(),\n    bsl = PiecewiseConstantBSL(),\n)","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"Finally, we load the interpolators of earth structure thanks to the convenience function load_dataset.","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"(_, _), Tpan, Titp = load_dataset(\"Lithothickness_Pan2022\")\nTlitho = Titp.(Lon, Lat) .* 1e3                     # convert from m to km\n(_, _, _), _, logeta_itp = load_dataset(\"Viscosity_Pan2022\")","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"The number of layers and the depth of viscous half-space are arbitrary parameters that have to be defined by the user. We here use a relatively shallow model (half-space begins at 300 km depth) with 1 equalisation layer and 3 intermediate layers.","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"mindepth = maximum(Tlitho) + 1e3\nlayerboundary_vec = range(mindepth, stop = 300e3, length = 3)\nlb = cat(Tlitho, [fill(lbval, domain.nx, domain.ny)\n    for lbval in layerboundary_vec]..., dims=3)\nrlb = c.r_equator .- lb\nnlb = size(rlb, 3)\nlv_3D = 10 .^ cat([logeta_itp.(Lon, Lat, rlb[:, :, k]) for k in 1:nlb]..., dims=3)\n\neta_lowerbound = 1e16\nlv_3D[lv_3D .< eta_lowerbound] .= eta_lowerbound\nmaskactive = gaussian_smooth(Hice_vec[k_lgm], domain, 0.05, 0) .> 10\nsolidearth = SolidEarth(\n    domain,\n    layer_boundaries = lb,\n    layer_viscosities = lv_3D,\n    maskactive = maskactive,    # required when using `InteractiveSealevelLoad`\n)\nfig = plot_earth(domain, solidearth)","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"This already looks like a much more exciting solid Earth structure!","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"Finally, we define the output struct, the Simulation and run! it.","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"nout = NativeOutput(vars = [:u, :ue, :dz_ss, :z_ss, :H_ice], t = [-26f3, -12f3, 0])\nsim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)\nrun!(sim)\nprintln(\"Computation time: \", sim.nout.computation_time)","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"Ok, that was fast! Let's visualise three snapshots of displacements that roughly correspond to LGM, the end of the meltwater pulse 1A and the present-day:","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"copts = (colormap = :PuOr, colorrange = (-500, 500))\nfig = plot_out_over_time(sim, :u_tot, [-26f3, -12f3, 0], copts)","category":"page"},{"location":"examples/glacialcycle/","page":"Glacial cycle","title":"Glacial cycle","text":"This looks very much like what is obtained by Seakon (Swierczek-Jereczek et al., 2024, Fig.9.g), a 3D GIA model.","category":"page"},{"location":"examples/alternative_models/#Alternative-models","page":"Alternative models","title":"Alternative models","text":"","category":"section"},{"location":"examples/alternative_models/#ELRA","page":"Alternative models","title":"ELRA","text":"","category":"section"},{"location":"examples/alternative_models/","page":"Alternative models","title":"Alternative models","text":"Sometimes people might want to use ELRA (LeMeur & Huybrechts, 1996):","category":"page"},{"location":"examples/alternative_models/","page":"Alternative models","title":"Alternative models","text":"using FastIsostasy, CairoMakie\n\nT, W, n = Float32, 3f6, 7\ndomain = RegionalDomain(W, n, correct_distortion = false)\n\nH_ice_0 = zeros(domain)\nH_ice_1 = 1f3 .* (domain.R .< 1f6)\nt_ice = [0, 1, 5f4]\nH_ice = [H_ice_0, H_ice_1, H_ice_1]\nit = TimeInterpolatedIceThickness(t_ice, H_ice, domain)\nbcs = BoundaryConditions(domain, ice_thickness = it)\nsealevel = SeaLevel()\n\nsolidearth = SolidEarth(\n    domain,\n    tau = 3f3,\n    lithosphere = RigidLithosphere(),\n    mantle = RelaxedMantle(),\n)\nnout = NativeOutput(vars = [:u, :ue, :dz_ss, :H_ice],\n    t = [0, 1f2, 3f2, 1f3, 3f3, 1f4, 2f4, 5f4])\n\nsim = Simulation(domain, bcs, sealevel, solidearth; nout = nout)\nrun!(sim)\nprintln(\"Took $(sim.nout.computation_time) seconds!\")\n\nfig = plot_transect(sim, [:u])","category":"page"},{"location":"examples/alternative_models/#ELRA-with-2D-relaxation-time","page":"Alternative models","title":"ELRA with 2D relaxation time","text":"","category":"section"},{"location":"examples/alternative_models/","page":"Alternative models","title":"Alternative models","text":"Sometimes people might want to use ELRA with 2D maps of the relaxation time (Van Calcar et al., 2025)","category":"page"},{"location":"examples/alternative_models/","page":"Alternative models","title":"Alternative models","text":"using LinearAlgebra\n\nsigma = diagm([(W/4)^2, (W/4)^2])\nlog10visc = generate_gaussian_field(domain, 21f0, [0f0, 0], -1f0, sigma)\nheatmap(log10visc)\nτ_weak = get_relaxation_time_weaker.(10 .^ log10visc)\nprintln(\"Extrema of weak 2D relaxation time: $(extrema(τ_weak))\")\n\nsolidearth_weak = SolidEarth(\n    domain,\n    tau = T.(τ_weak),\n    lithosphere = RigidLithosphere(),\n    mantle = RelaxedMantle(),\n)\nsim_weak = Simulation(domain, bcs, sealevel, solidearth_weak; nout = nout)\nrun!(sim_weak)\nfig = plot_transect(sim_weak, [:u])","category":"page"},{"location":"examples/alternative_models/","page":"Alternative models","title":"Alternative models","text":"Alternatively:","category":"page"},{"location":"examples/alternative_models/","page":"Alternative models","title":"Alternative models","text":"τ_strong = get_relaxation_time_stronger.(10 .^ log10visc)\nprintln(\"Extrema of strong 2D relaxation time: $(extrema(τ_strong))\")\n\nsolidearth_strong = SolidEarth(\n    domain,\n    tau = T.(τ_strong),\n    lithosphere = RigidLithosphere(),\n    mantle = RelaxedMantle(),\n)\nsim_strong = Simulation(domain, bcs, sealevel, solidearth_strong; nout = nout)\nrun!(sim_strong)\nfig = plot_transect(sim_strong, [:u])","category":"page"},{"location":"#FastIsostasy.jl","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"","category":"section"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"❄ Fast and flexible glacial isostatic adjustment on CPU and GPU.","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"warning: Upgrade to v2.0!\nFastIsostasy.jl has been refactored to fix some performance issues, offer a more versatile API and propose new features. FastIsostasy v2.0 is currently being tested and will be out soon. If you are using v1.0, we strongly encourage you to uprade to v2.0 when it comes out!","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"(Image: GlacialCycle)","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"FastIsostasy is a collection of models to compute the regional glacial isostatic adjustment (GIA) resulting from changes in the surface load (ice, liquid water and sediments). It is:","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"Accessible: you can set up complex simulations with only a few lines of code, as demonstrated for the case of the last glacial cycle.\nFlexible: you can easily permute parameters and modelling choices to play Earth System Modelling like it's lego.\nPerformant: the results obtained only marginally differ from those obtained by 1D and 3D GIA models, while displaying a speed-up of 2 to 6 orders of magnitude.","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"tip: Star us on GitHub!\nIf you have found this library useful, please consider starring it on GitHub. This gives us a lower bound of the satisfied user count.","category":"page"},{"location":"#Getting-started","page":"FastIsostasy.jl","title":"Getting started","text":"","category":"section"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"FastIsostasy.jl is a registered julia package. To install it, simply run:","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"using Pkg\nPkg.add(\"FastIsostasy\")","category":"page"},{"location":"#How-to-read-the-docs?","page":"FastIsostasy.jl","title":"How to read the docs?","text":"","category":"section"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"If you want a quick introduction to GIA, please go to Quick intro to GIA. If you want to have a thorough but still accessbile introduction to GIA, we highly recommend reading Whitehouse et al. (2019). If you want to get started right away, feel free to directly go to the Tutorial. If you face any problem using the code or want to know more about the functionalities of the package, visit the API reference. If you face a problem you cannot solve, please open a GitHub issue with a minimal and reproduceable example. We also welcome feature requests!","category":"page"},{"location":"#How-to-cite?","page":"FastIsostasy.jl","title":"How to cite?","text":"","category":"section"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"Swierczek-Jereczek, J., Montoya, M., Latychev, K., Robinson, A., Alvarez-Solas, J., & Mitrovica, J. (2024). FastIsostasy v1.0 – a regional, accelerated 2D glacial isostatic adjustment (GIA) model accounting for the lateral variability of the solid Earth. Geoscientific Model Development, 17(13), 5263-5290.","category":"page"},{"location":"#Juliaecosystem","page":"FastIsostasy.jl","title":"Julia ecosystem","text":"","category":"section"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"FastIsostasy.jl was written thanks to the sheer amount of work that people invested in the vast and well-documented Julia ecosystem. Major help from packages deserves major appreciation, in particular for:","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"FFTW.jl\nCUDA.jl\nParallelStencil.jl\nInterpolations.jl\nOrdinaryDiffEq.jl\nSpecialFunctions.jl\nFastGaussQuadrature.jl\nProj.jl\nAnd all the fantastic development tools that ease the every-day work so much: Documenter.jl, Literate.jl, Test.jl and DocumenterCitations.jl. Oceananigans and SpeedyWeather provided fantastic templates in terms of API, code structure and documentation.","category":"page"}]
}
