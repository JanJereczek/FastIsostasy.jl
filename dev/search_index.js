var documenterSearchIndex = {"docs":
[{"location":"examples/#Examples","page":"Examples","title":"Examples","text":"","category":"section"},{"location":"examples/#Multi-layer-Earth","page":"Examples","title":"Multi-layer Earth","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"FastIsostasy relies on a (polar) stereographic projection that allows to treat the radially-layered, onion-like structure of the solid Earth as a superposition of horizontal layers. Furthermore, FastIsostasy reduces this 3D problem into a 2D problem by collapsing the depth dimension, mainly through the computation of an effective viscosity field that accounts for the superposition of layers with different viscosities. The user is required to provide the 3D information, which will then be used under the hood to compute the effective viscosity. This tutorial shows such an example.","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"We want to render a situation similar to the one depicted below:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"(Image: Schematic representation of the three-layer set-up.)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"Initializing a LateralVariability with parameters corresponding to this situation automatically computes the conversion from a 3D to a 2D problem. This can be simply executed by running:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"using FastIsostasy\n\nW = 3000e3      # (m) half-width of the domain Wx = Wy\nn = 6           # implies an Nx x Ny grid with Nx = Ny = 2^n = 64.\nOmega = ComputationDomain(W, n)\nc = PhysicalConstants(rho_litho = 0.0)\n\nlv = [1e19, 1e21]       # (Pa s)\nlb = [88e3, 400e3]      # (m)\np = LateralVariability(Omega, layer_viscosities = lv, layer_boundaries = lb)\nextrema(p.effective_viscosity)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"As expected, the effective viscosity is a homogeneous field. It corresponds to a nonlinear mean of the layered values provided by the user. Note that we have set ŗho_mathrmlitho = 0 to prevent the lithosphere from contributing to the hydrostatic, upward force. This is made to comply with the later computed analytical solution, which assumes a purely elastic lithosphere. In reality, this is however arguably wrong and the default choice c = PhysicalConstants() therefore uses ŗho_mathrmlitho = 2600  mathrmkg  m^-3.","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"The next section shows how to use the now obtained p::LateralVariability for actual GIA computation.","category":"page"},{"location":"examples/#Simple-load-and-geometry","page":"Examples","title":"Simple load and geometry","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"We now apply a constant load, here a cylinder of ice with radius R = 1000  mathrmkm and thickness H = 1  mathrmkm, over Omega::ComputationDomain introduced in Multi-layer Earth. To formulate the problem conviniently, we use FastIsoProblem, a struct containing the variables and options that are necessary to perform the integration over time. We can then simply apply solve!(fip::FastIsoProblem) to perform the integration of the ODE. Under the hood, the ODE is obtained from the PDE by applying a Fourier collocation scheme contained in dudt_isostasy!. The integration is performed according to FastIsoProblem.diffeq::NamedTuple, which contains the algorithm and optionally tolerances, maximum iteration number... etc.","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"using CairoMakie\n\nR = 1000e3                  # ice disc radius (m)\nH = 1e3                     # ice disc thickness (m)\nHice = uniform_ice_cylinder(Omega, R, H)\nt_out = years2seconds.([0.0, 200.0, 600.0, 2000.0, 5000.0, 10_000.0, 50_000.0])\ninteractive_sealevel = false\n\nfip = FastIsoProblem(Omega, c, p, t_out, interactive_sealevel, Hice)\nsolve!(fip)\nfunction plot3D(fip, k_idx)\n    X, Y, out = Array(fip.Omega.X), Array(fip.Omega.Y), fip.out\n    zl = extrema(out.ue[end] + out.u[end])\n    fig = Figure(fontsize = 10)\n    for j in eachindex(k_idx)\n        ax = Axis3(fig[1, j])\n        u_tot = out.ue[k_idx[j]] + out.u[k_idx[j]]\n        surface!(ax, X, Y, u_tot, colormap = :cool)\n        wireframe!(ax, X, Y, u_tot, color = :black, linewidth = 0.1)\n        zlims!(ax, zl)\n    end\n    return fig\nend\nplot3D(fip, [lastindex(t_out) ÷ 2, lastindex(t_out)])","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"... and here goes the total displacement at t = 50  mathrmkyr! You can now access the elastic and viscous displacement at time t_out[k] by respectively calling fip.out.ue[k] and fip.out.u[k]. For the present case, the latter can be compared to an analytic solution that is known for this particular case. Let's look at the accuracy of our numerical scheme over time by running following plotting commands:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"fig = Figure(fontsize = 10)\nax = Axis(fig[1, 1])\ncmap = cgrad(:jet, length(t_out), categorical = true)\nii, jj = Omega.Mx:Omega.Nx, Omega.My\nx = Omega.X[ii, jj]\nr = Omega.R[ii, jj]\n\n# A support vector for computing the analytical solution\nvsupport = vcat(1.0e-14, 10 .^ (-10:0.05:-3), 1.0)\n\nfor k in eachindex(t_out)\n    analytic_solution_r(r) = analytic_solution(r, t_out[k], c, p, H, R, vsupport)\n    u_analytic = analytic_solution_r.(r)\n    u_numeric = fip.out.u[k][ii, jj]\n    lines!(ax, x, u_analytic, color = cmap[k], linewidth = 5,\n        label = L\"$u_{ana}(t = %$(round(seconds2years(t_out[k]))) \\, \\mathrm{yr})$\")\n    lines!(ax, x, u_numeric, color = cmap[k], linewidth = 5, linestyle = :dash,\n        label = L\"$u_{num}(t = %$(round(seconds2years(t_out[k]))) \\, \\mathrm{yr})$\")\nend\naxislegend(ax, position = :rb, nbanks = 2, patchsize = (50.0f0, 20.0f0))\nfig","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"That looks pretty good! One might however object that the convenience function fastisostasy ends up being not so convenient as soon as the ice load changes over time. This case can however be easily handled, as shown in the next section.","category":"page"},{"location":"examples/#GPU-support","page":"Examples","title":"GPU support","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"For about n  6, the previous example can be computed even faster by using GPU parallelism. It could not represent less work from the user's perspective, as it boils down to calling ComputationDomain with an extra keyword argument and passing it to a ::LateralVariability with the viscosity and depth values defined earlier:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"n = 7\nOmega = ComputationDomain(W, n, use_cuda = true)\np = LateralVariability(Omega, layer_viscosities = lv, layer_boundaries = lb)\nHice = uniform_ice_cylinder(Omega, R, H)\nfip = FastIsoProblem(Omega, c, p, t_out, interactive_sealevel, Hice)\nsolve!(fip)\nplot3D(fip, [lastindex(t_out) ÷ 2, lastindex(t_out)])","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"That's it, nothing more! For postprocessing, consider using reinit_structs_cpu.","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"info: Only CUDA supported!\nFor now only Nvidia GPUs are supported and there is no plan of extending this compatibility at this point.","category":"page"},{"location":"examples/#Make-your-own-time-loop","page":"Examples","title":"Make your own time loop","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"As any high-level function, solve! has some limitations. An ice-sheet modeller typically wants to embed FastIsostasy within a time-stepping loop. This can be easily done by getting familiar with some intermediate-level functions like init, step! and write_out!:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"Omega = ComputationDomain(3000e3, 6)\np = LateralVariability(Omega)\nHice = uniform_ice_cylinder(Omega, R, H)\nfip = FastIsoProblem(Omega, c, p, t_out, interactive_sealevel, Hice)\n\nupdate_diagnostics!(fip.geostate.dudt, fip.geostate.u, fip, 0.0)\nwrite_out!(fip, 1)\node = init(fip)\n@inbounds for k in eachindex(fip.out.t)[2:end]\n    step!(fip, ode, (fip.out.t[k-1], fip.out.t[k]))\n    write_out!(fip, k)\nend\nplot3D(fip, [lastindex(t_out) ÷ 2, lastindex(t_out)])","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"info: Coupling to julia Ice-Sheet model\nIn case your Ice-Sheet model is programmed in julia, we highly recommend performing the coupling within the function updating the derivatives and let OrdinaryDiffEq.jl handle the rest.","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"info: GPU not supported\nstep! does not support GPU computation so far. Make sure your model is initialized on CPU!","category":"page"},{"location":"examples/#Antarctic-deglaciation","page":"Examples","title":"Antarctic deglaciation","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"We now want to provide an example that presents:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"a heterogeneous lithosphere thickness\na heterogeneous upper-mantle viscosity\nvarious viscous channels\na more elaborate load that evolves over time\nchanges in the sea-level","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"For this we run a deglaciation of Antarctica with lithospheric thickness and upper-mantle viscosity from [Wiens2021] and the ice thickness history from [Briggs2014]. Since the load is known and the isostatic response does not influence it (one-way coupling), we can provide snapshots of the ice thickness and their associated time to FastIsoProblem. Under the hood, an interpolator is created and called within the time integration. ","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"W = 3000e3      # (m) half-width of the domain\nn = 7           # implies an NxN grid with N = 2^n = 128.\nOmega = ComputationDomain(W, n)\nc = PhysicalConstants()","category":"page"},{"location":"examples/#Inversion-of-viscosity-field","page":"Examples","title":"Inversion of viscosity field","text":"","category":"section"},{"location":"examples/","page":"Examples","title":"Examples","text":"FastIsostasy.jl relies on simplification of the full problem and might therefore need a calibration step to match the data, typically obtained from observations or from a \"golden-standard\" 3D GIA model. By means of an unscented Kalman inversion, one can e.g. infer the appropriate field of effective mantle viscosity that matches the data best. Whereas this is known to be a tedious step, FastIsostasy is developped to ease the procedure by providing a convenience struct Paraminversion that can be run by:","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"Omega = ComputationDomain(3000e3, 6)\nlb = [88e3, 180e3, 280e3, 400e3]\nlv = get_wiens_layervisc(Omega)\np = LateralVariability(Omega, layer_boundaries = lb, layer_viscosities = lv)\nR, H = 2000e3, 1e3\nHcylinder = uniform_ice_cylinder(Omega, R, H)\nHice = [Hcylinder for t in t_out]\nt_out = years2seconds.(1_000.0:1_000.0:2_000.0)\nfip = FastIsoProblem(Omega, c, p, t_out, interactive_sealevel, Hice)\nsolve!(fip)\nground_truth = copy(p.effective_viscosity)\n\nconfig = InversionConfig()\ndata = InversionData(t_out, fip.out.u, Hice, config)\nparaminv = ParamInversion(Omega, c, p, config, data)\npriors, ukiobj = perform(paraminv)\nlogeta, Gx, e_mean, e_sort = extract_inversion(priors, ukiobj, paraminv)","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"[Wiens2021]: Douglas Wiens et al. (2021): The seismic structure of the Antarctic upper mantle","category":"page"},{"location":"examples/","page":"Examples","title":"Examples","text":"[Briggs2014]: Robert Briggs et al. (2014): A data constrained large ensemble analysis of Antarctic evolution since the Eemian","category":"page"},{"location":"collected_garbage/","page":"-","title":"-","text":"<!– ","category":"page"},{"location":"collected_garbage/","page":"-","title":"-","text":"Inferring the lithospheric thickness and the upper-mantle viscosity is all but trivial since ice sheets famously present difficult access to scientific missions, leading to a lack of seismologic stations compared to other regions of the world. The presence of few kilometers of ice between most stations and the bedrock is a further challenge. Although major advances have been recently made, Antarctica is therefore the region where solid-Earth parameters are worst-constrained.","category":"page"},{"location":"collected_garbage/","page":"-","title":"-","text":"[ 1, 2 ].","category":"page"},{"location":"collected_garbage/","page":"-","title":"-","text":"Compared to [1, 2], FastIsostasy.jl does not assume constant fields for parameters of the solid Earth. It thus offers an open-source and performant generalization of the original articles.  This allows to transform the PDE describing the physics into an ODE and accelerate the computation, mainly due to the highly optimized functions available for fast-fourier transform (FFT).","category":"page"},{"location":"collected_garbage/","page":"-","title":"-","text":"Computing the vertical displacement of the bedrock can be computed much more efficiently by relying on the precomputation of some terms and operations. In FastIsostasy.jl, this can be easily performed:","category":"page"},{"location":"collected_garbage/","page":"-","title":"-","text":"–>","category":"page"},{"location":"collected_garbage/","page":"-","title":"-","text":"<!– ","category":"page"},{"location":"collected_garbage/#A-three-layer-model","page":"-","title":"A three-layer model","text":"","category":"section"},{"location":"collected_garbage/","page":"-","title":"-","text":"Let x, y be the coordinates spanning the projection of the Earth surface and z the depth coordinate. The present model assumes three layers over the z-dimension:","category":"page"},{"location":"collected_garbage/","page":"-","title":"-","text":"The elastic lithosphere.\nA channel representing the upper mantle, usually displaying strong variance of viscosity over x and y.\nA half-space representing the rest of the mantle, usually with small variance of viscosity over x and y.","category":"page"},{"location":"collected_garbage/","page":"-","title":"-","text":"The two-layer model is a special case of this and can be obtained by setting the channel parameters to be the same as the ones of the half space.","category":"page"},{"location":"collected_garbage/","page":"-","title":"-","text":"(Image: Schematic representation of the three-layer model) –>","category":"page"},{"location":"collected_garbage/#Arrays","page":"-","title":"Arrays","text":"","category":"section"},{"location":"collected_garbage/","page":"-","title":"-","text":"Array dimensions correspond to the spatial dimension of the variable they describe. If they evolve over time, they are stored as vector of arrays. For instance, the vertical displacement of the bedrock is a 2D variable that evolves over time. Therefore, it is stored in a Vector{Matrix}.","category":"page"},{"location":"APIref/#API-reference","page":"API reference","title":"API reference","text":"","category":"section"},{"location":"APIref/#Basic-structs","page":"API reference","title":"Basic structs","text":"","category":"section"},{"location":"APIref/","page":"API reference","title":"API reference","text":"KernelMatrix\nComputationDomain\nPhysicalConstants\nLateralVariability\nRefGeoState\nGeoState\nFastIsoTools\nFastIsoProblem","category":"page"},{"location":"APIref/#FastIsostasy.KernelMatrix","page":"API reference","title":"FastIsostasy.KernelMatrix","text":"KernelMatrix\n\nAn allias for Union{Matrix{T}, CuMatrix{T}} where {T<:AbstractFloat}.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.ComputationDomain","page":"API reference","title":"FastIsostasy.ComputationDomain","text":"ComputationDomain\nComputationDomain(W, n)\nComputationDomain(Wx, Wy, Nx, Ny)\n\nReturn a struct containing all information related to geometry of the domain and potentially used parallelism. To initialize one with 2*W and 2^n grid cells:\n\nOmega = ComputationDomain(W, n)\n\nIf a rectangular domain is needed, run:\n\nOmega = ComputationDomain(Wx, Wy, Nx, Ny)\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.PhysicalConstants","page":"API reference","title":"FastIsostasy.PhysicalConstants","text":"PhysicalConstants\n\nReturn a struct containing important physical constants. Comes with default values that can however be changed by the user, for instance by running:\n\nc = PhysicalConstants(rho_ice = 0.93)   # (kg/m^3)\n\nAll constants are given in SI units (kilogram, meter, second).\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.LateralVariability","page":"API reference","title":"FastIsostasy.LateralVariability","text":"LateralVariability(Omega; layer_boundaries, layer_viscosities)\n\nReturn a struct containing all information related to the lateral variability of solid-Earth parameters. To initialize with values other than default, run:\n\nOmega = ComputationDomain(3000e3, 7)\nlb = [100e3, 300e3]\nlv = [1e19, 1e21]\np = LateralVariability(Omega, layer_boundaries = lb, layer_viscosities = lv)\n\nwhich initializes a lithosphere of thickness T_1 = 100 mathrmkm, a viscous channel between T_1 and T_2 = 200 mathrmkm and a viscous halfspace starting at T_2. This represents a homogenous case. For heterogeneous ones, simply make lb::Vector{Matrix}, lv::Vector{Matrix} such that the vector elements represent the lateral variability of each layer on the grid of Omega::ComputationDomain.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.RefGeoState","page":"API reference","title":"FastIsostasy.RefGeoState","text":"RefGeoState\n\nReturn a struct containing the reference GeoState.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.GeoState","page":"API reference","title":"FastIsostasy.GeoState","text":"GeoState\n\nReturn a mutable struct containing the geostate which will be updated over the simulation. The geostate contains all the states of the [FastIsoProblem] to be solved.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.FastIsoTools","page":"API reference","title":"FastIsostasy.FastIsoTools","text":"FastIsoTools(Omega::ComputationDomain, c::PhysicalConstants, p::LateralVariability)\n\nReturn a struct containing pre-computed tools to perform forward-stepping of the model. This includes the Green's functions for the computation of the lithosphere and geoid displacement, plans for FFTs, interpolators of the load and the viscosity over time and preallocated arrays.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.FastIsoProblem","page":"API reference","title":"FastIsostasy.FastIsoProblem","text":"FastIsoProblem(Omega, c, p, t_out, interactive_sealevel)\nFastIsoProblem(Omega, c, p, t_out, interactive_sealevel, Hice)\nFastIsoProblem(Omega, c, p, t_out, interactive_sealevel, t_Hice, Hice)\n\nReturn a struct containing all the other structs needed for the forward integration of the model over Omega::ComputationDomain with parameters c::PhysicalConstants and p::LateralVariability. The outputs are stored at t_out::Vector{<:AbstractFloat}.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#Mechanics","page":"API reference","title":"Mechanics","text":"","category":"section"},{"location":"APIref/","page":"API reference","title":"API reference","text":"solve!\nstep!\nupdate_diagnostics!\ndudt_isostasy!\nupdate_elasticresponse!","category":"page"},{"location":"APIref/#FastIsostasy.solve!","page":"API reference","title":"FastIsostasy.solve!","text":"solve!(fip)\n\nSolve the isostatic adjustment problem defined in fip::FastIsoProblem.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.step!","page":"API reference","title":"FastIsostasy.step!","text":"init(fip)\n\nStep fip::FastIsoProblem over tspan and based on ode::CoupledODEs, typically obtained by init.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.update_diagnostics!","page":"API reference","title":"FastIsostasy.update_diagnostics!","text":"update_diagnostics!(dudt, u, fip, t)\n\nUpdate all the diagnotisc variables, i.e. all fields of fip.geostate apart from the displacement, which requires an integrator.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.dudt_isostasy!","page":"API reference","title":"FastIsostasy.dudt_isostasy!","text":"dudt_isostasy!()\n\nUpdate the displacement rate dudt of the viscous response.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.update_elasticresponse!","page":"API reference","title":"FastIsostasy.update_elasticresponse!","text":"update_elasticresponse!(fip::FastIsoProblem)\n\nUpdate the elastic response by convoluting the Green's function with the load anom. To use coefficients differing from [Farrell1972], see FastIsoTools.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Parameter-inversion","page":"API reference","title":"Parameter inversion","text":"","category":"section"},{"location":"APIref/","page":"API reference","title":"API reference","text":"InversionConfig\nInversionData\nParamInversion\nperform","category":"page"},{"location":"APIref/#FastIsostasy.InversionConfig","page":"API reference","title":"FastIsostasy.InversionConfig","text":"InversionConfig\n\nStruct containing configuration parameters for a [ParamInversion].\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.InversionData","page":"API reference","title":"FastIsostasy.InversionData","text":"InversionData\n\nStruct containing data (either observational or output of a golden standard model) for a [ParamInversion].\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.ParamInversion","page":"API reference","title":"FastIsostasy.ParamInversion","text":"ParamInversion\n\nStruct containing variables and configs for the inversion of Solid-Earth parameter fields. For now, only viscosity can be inverted but future versions will support lithosphere rigidity. For now, the unscented Kalman inversion is the only method available but ensemble Kalman inversion will be available in future.\n\n\n\n\n\n","category":"type"},{"location":"APIref/#FastIsostasy.perform","page":"API reference","title":"FastIsostasy.perform","text":"perform(paraminv::ParamInversion)\n\nReturn priors and ukiobj that allow to extract the results of the parameter inversion as initialized in paraminv.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#Utils","page":"API reference","title":"Utils","text":"","category":"section"},{"location":"APIref/","page":"API reference","title":"API reference","text":"years2seconds\nseconds2years\nm_per_sec2mm_per_yr\nmeshgrid\nscalefactor\nlatlon2stereo\nstereo2latlon","category":"page"},{"location":"APIref/#FastIsostasy.years2seconds","page":"API reference","title":"FastIsostasy.years2seconds","text":"years2seconds(t::Real)\n\nConvert input time t from years to seconds.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.seconds2years","page":"API reference","title":"FastIsostasy.seconds2years","text":"seconds2years(t::Real)\n\nConvert input time t from seconds to years.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.m_per_sec2mm_per_yr","page":"API reference","title":"FastIsostasy.m_per_sec2mm_per_yr","text":"m_per_sec2mm_per_yr(dudt::Real)\n\nConvert displacement rate dudt from $ m \\, s^{-1} $ to $ mm \\, \\mathrm{yr}^{-1} $.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.meshgrid","page":"API reference","title":"FastIsostasy.meshgrid","text":"meshgrid(x, y)\n\nReturn a 2D meshgrid spanned by x, y.\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.latlon2stereo","page":"API reference","title":"FastIsostasy.latlon2stereo","text":"latlon2stereo(lat, lon, lat0, lon0)\n\nCompute stereographic projection (x,y) for a given latitude lat longitude lon, reference latitude lat0 and reference longitude lon0. Optionally one can provide lat::KernelMatrix and lon::KernelMatrix if the projection is to be computed for the whole domain. Note: angles must be provided in degrees! Reference: John P. Snyder (1987), p. 157, eq. (21-2), (21-3), (21-4).\n\n\n\n\n\n","category":"function"},{"location":"APIref/#FastIsostasy.stereo2latlon","page":"API reference","title":"FastIsostasy.stereo2latlon","text":"stereo2latlon(x, y, lat0, lon0)\n\nCompute the inverse stereographic projection (lat, lon) based on Cartesian coordinates (x,y) and for a given reference latitude lat0 and reference longitude lon0. Optionally one can provide x::KernelMatrix and y::KernelMatrix if the projection is to be computed for the whole domain. Note: angles must be  para elloprovided in degrees!\n\nConvert stereographic (x,y)-coordinates to latitude-longitude. Reference: John P. Snyder (1987), p. 159, eq. (20-14), (20-15), (20-18), (21-15).\n\n\n\n\n\n","category":"function"},{"location":"APIref/","page":"API reference","title":"API reference","text":"[Goelzer2020]: Heiko Goelzer et al. (2020): Brief communication: On calculating the sea-level contribution in marine ice-sheet models","category":"page"},{"location":"APIref/","page":"API reference","title":"API reference","text":"[Snyder1987]: John Snyder (1987): Map projections – A working manual","category":"page"},{"location":"APIref/","page":"API reference","title":"API reference","text":"[Farrell1972]: William Farrel (1972): Deformation of the Earth by surface Loads, Farell 1972","category":"page"},{"location":"#FastIsostasy.jl","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"","category":"section"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"❄ Fast and friendly glacial isostatic adjustment on CPU and GPU.","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"FastIsostasy is a friendly and flexible software package for simulations of the glacial isostatic adjustment (GIA) with laterally-variable solid-Earth parameters, i.e. the mantle viscosity and the lithospheric thickness. It is mainly adressed to ice-sheet modellers who seek for (1) a good representation of solid-Earth mechanics at virtually zero computational cost, (2) an approximation of the sea-level equation and (3) ready-to-use inversion tools to calibrate the model parameters to data. The simple interface of FastIsostasy allows to flexibly solve GIA problems within few lines of code. It is fully open-source under MIT license and was succesfully benchmarked against analytical, 1D GIA and 3D GIA model solutions.","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"FastIsostasy relies on a hybrid Fourier/finite-difference collocation of the problem introduced in [Cathles1975] and solved in [Lingle1985], [Bueler2007]. Thanks to a simplification of the full problem from 3D to 2D space and the use of optimized software packages, running kiloyears of regional GIA with Delta x = Delta y simeq 45  mathrmkm is a matter of seconds on a single CPU. For very high resolution runs, the user can switch to GPU usage with minimal syntax change and enjoy the advantage of parallelization without requiring an HPC cluster. The central place of Fast-Fourier transforms in FastIsostasy's solving scheme inspired its name, along with a GitHub repository that eased the first steps of this package. For GIA \"purists\", this package is likely to miss interesting processes but we belive that its ridiculous run-time can help to fast-prototype a problem before transfering it to a more comprehensive model.","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"tip: Star us on GitHub!\nIf you have found this library useful, please consider starring it on GitHub. This gives us a lower bound of the satisfied user count.","category":"page"},{"location":"#Getting-started","page":"FastIsostasy.jl","title":"Getting started","text":"","category":"section"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"FastIsostasy.jl is work under devlopment and is not a registered julia package yet. To install it, please run:","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"using Pkg\nPkg.add(\"https://github.com/JanJereczek/FastIsostasy.jl\")","category":"page"},{"location":"#How-to-read-the-docs?","page":"FastIsostasy.jl","title":"How to read the docs?","text":"","category":"section"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"If you want a quick introduction to GIA, please go to A quick introduction to GIA. If you want to have a thorough but still accessbile introduction to GIA, we highly recommend reading [Whitehouse2019]. If you want to get started right away, feel free to directly go to the Examples. If you face any problem using the code or want to know more about the functionalities of the package, visit the API reference. If you face a problem you cannot solve or have feature requests, please open a GitHub issue with a minimal and reproduceable example.","category":"page"},{"location":"#Juliaecosystem","page":"FastIsostasy.jl","title":"Julia ecosystem","text":"","category":"section"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"FastIsostasy.jl was written thanks to the shear amount of work that people invested in the vast and well-documented Julia ecosystem. Major help from packages deserves major appreciation, namely for:","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"FFTW.jl\nCUDA.jl\nParallelStencil.jl\nInterpolations.jl\nOrdinaryDiffEq.jl\nDynamicalSystemsBase.jl\nDSP.jl\nKalmanEnsembleProcesses.jl","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"[Whitehouse2019]: Pippa Whitehouse et al. (2019): Solid Earth change and the evolution of the Antarctic Ice Sheet  (https://esurf.copernicus.org/articles/6/401/2018/)","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"[Cathles1975]: Lawrence Cathles (1985): Viscosity of the Earth's mantle","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"[Lingle1985]: Lingle and Clark (1985): A numerical model of interactions between a marine ice sheet and the solid earth: Application to a West Antarctic ice stream","category":"page"},{"location":"","page":"FastIsostasy.jl","title":"FastIsostasy.jl","text":"[Bueler2007]: Ed Bueler et al. (2007): Fast computation of a viscoelastic deformable Earth model for ice-sheet simulations","category":"page"},{"location":"introGIA/#A-quick-introduction-to-GIA","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"","category":"section"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"The evolution of cryosphere components leads to changes in the vertical load applied upon the solid Earth, namely through changes of the ice, liquid water and sediment columns. Glacial isostatic adjustment (GIA) denotes the mechanical response of the solid Earth, which is characterized by its vertical and horizontal displacement. GIA models usually encompass related processes, such as the resulting changes in sea-surface height and the migration of shorelines.","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"The magnitude and time scale of GIA depends on the applied load and on solid-Earth parameters, i.e. the mantle viscosity, the lithosphere thickness and their respective density. These parameters display a radial and sometimes also a lateral variability, further jointly denoted by parameter \"heterogeneity\". For further details, please refer to [Wiens2021] and [Ivins2023].","category":"page"},{"location":"introGIA/#Why-do-we-care?","page":"A quick introduction to GIA","title":"Why do we care?","text":"","category":"section"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"GIA is known to present many feedbacks on ice-sheet evolution. Their net effect is negative, meaning that GIA inhibits ice-sheet growth and retreat. In other words, it tends to stabilize a given state and is therefore particularly important in the context of paleo-climate and climate change.","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"The speed and magnitude of anthropogenic warming is a potential threat to the Greenland and the West-Antarctic ice sheets. They both represent an ice volume that could lead to multi-meter sea-level rise. The effect of GIA in this context appears to be particularly relevant - not only from a theoretical but also from a practical perspective, as a large portion of human livelihoods are concentrated along coasts.","category":"page"},{"location":"introGIA/#Overview-of-GIA-models-for-ice-sheet-simulation","page":"A quick introduction to GIA","title":"Overview of GIA models for ice-sheet simulation","text":"","category":"section"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"GIA models present a wide range of complexity, which can only be briefly mentioned here. On the lower end, models such as the Elastic-Lithopshere/Viscous-Asthenopshere are cheap to run and easy to implement, which has made them popular within the ice-sheet modelling community. They present some acceptable limitations such as regionally approximating a global problem and lacking the radially layered structure of the solid Earth. However, some limitations have shown to be too important to be overlooked:","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"The GIA response is independent of the load's wavelength.\nThe heterogeneity of the lithospheric thickness and upper-mantle viscosity cannot be represented.\nChanges in sea-surface height due to changes in mass repartition are ignored.","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"On the higher end of the complexity spectrum, we find the 3D GIA models which address all the limitations of low-complexity models but are expensive to run, more tedious to couple to an ice-sheet model and generally lack a well-documented and open-source code base. Due to these drawbacks, they do not represent a standard tool within the ice-sheet modelling community. Although, they are becoming increasingly used, as for instance in [Gomez2018] and [VanCalcar2023], we believe that the expense of 3D GIA models can be avoided while still addressing the aforementioned limitations of simplistic models. Models specifically designed for ice-sheet modelling, such as [Bueler2007] and [Coulon2021], have shown first improvements in closing the gap between simplistic and expensive models. FastIsostasy continues this work by generalizing both of these contributions into one","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"We here omit to speak about other GIA models, since they lack the representation of heterogeneous solid-Earth parameters.","category":"page"},{"location":"introGIA/#Where-is-FastIsosatsy.jl-on-the-complexity-ladder?","page":"A quick introduction to GIA","title":"Where is FastIsosatsy.jl on the complexity ladder?","text":"","category":"section"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":", while benchmarking results against 1D and 3D GIA models.","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"FastIsostasy heavily relies on the Fast-Fourier Transform (FFT), as (1) its central PDE is solved by applying a Fourier collocation scheme and (2) important diagnostic fields are computed by matrix convolutions which can famously be accelerated by the use of FFT. FFT therefore inspired the name \"FastIsostasy\", along with a GitHub repository that eased the first steps of this package. The use of a performant language such as julia, as well as supporting performance-relevant computations on GPU allows FastIsostasy to live up to the expectations of low computation time.","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"We believe that FastIsostasy drastically reduces the burdens associated with using a 3D GIA model while offering all the complexity needed for ice-sheet modelling. As targeted and efficient climate-change mitigation relies on a good representation of important mechanisms in numerical models, we believe that this can be a significant contribution for future research.","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"[Wiens2021]: Douglas Wiens et al. (2021): The seismic structure of the Antarctic upper mantle","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"[Ivins2023]: Erik Ivins et al. (2023): Antarctic upper mantle rheology","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"[Gomez2018]: Natalya Gomez et al. (2018): A Coupled Ice Sheet-Sea Level Model Incorporating 3D Earth Structure: Variations in Antarctica during the Last Deglacial Retreat","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"[VanCalcar2023]: Caroline van Calcar et al. (2023): Simulation of a fully coupled 3D GIA - ice-sheet model for the Antarctic Ice Sheet over a glacial cycle","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"[Bueler2007]: Ed Bueler et al. (2007): Fast computation of a viscoelastic deformable Earth model for ice-sheet simulations","category":"page"},{"location":"introGIA/","page":"A quick introduction to GIA","title":"A quick introduction to GIA","text":"[Coulon2021]: Violaine Coulon et al. (2021): Contrasting Response of West and East Antarctic Ice Sheets to Glacial Isostatic Adjustment","category":"page"}]
}
